TCM8593_1_Email,select top 10 lr.recipient,ls.StatusID from xLeads.dbo.lead_recipient lr,xLeads.lead.lead ll,xLeads.Lead.Status ls with (nolock) where ls.leadid = ll.leadid and lr.leadid = ll.leadid and ll.emailaddress = $$EmailAddress$$
TCM8593_1_del,select top 10 lr.recipient,ls.StatusID from xLeads.dbo.lead_recipient lr,xLeads.lead.lead ll,xLeads.Lead.Status ls with (nolock) where ls.leadid = ll.leadid and lr.leadid = ll.leadid and ll.firstname = $$FirstName$$ and ll.emailaddress = $$EmailAddress$$ and ll.createdate>=$$CurrentDate$$
TCM8593_1,select top 1 lr.recipient, ll.emailaddress, ll.firstname, ls.statusid  from xLeads.lead.lead ll join xLeads.dbo.lead_recipient lr (nolock) on lr.recipient = ll.emailaddress join xLeads.Lead.Status ls (nolock) on lr.leadid = ls.leadid where  ll.firstname like $$FirstName$$ and lr.recipient = $$EmailAddress$$ and ll.createdate>=$$CurrentDate$$
getLeadID,select top 1 ll.leadID, ll.FirstName, ll.createdate from xLeads.lead.lead ll where ll.firstname like $$FirstName$$ and ll.emailaddress = $$EmailAddress$$ and ll.createdate>=$$CurrentDate$$
TCM8593_2,select top 10 lr.recipient,ls.StatusID from xLeads.dbo.lead_recipient lr,xLeads.lead.lead ll,xLeads.Lead.Status ls with (nolock) where ls.leadid = ll.leadid and lr.leadid = ll.leadid and ll.leadid = $$LeadID$$
TCM8593_3,WITH a AS (SELECT top 1000 s.mpr_id,L.source_alias_id, (s.address_line + ','+s.city+','+ s.state_code+','+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask in ('8','128') and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and l.city = 'Binder'and s.property_status = 'For Sale' and l.source_alias_id like 'PROD%') SELECT top 1 a.* FROM a Order by NEWID ()
TCM8594,WITH a AS (SELECT top 1000 s.mpr_id,L.source_alias_id, (s.address_line + ','+s.city+','+ s.state_code+','+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask in ('16','256','2048') and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and l.city = 'Binder' and s.property_status = 'For Sale'and l.source_alias_id like 'PROD%') SELECT top 1 a.* FROM a Order by NEWID ()
TCM8595,WITH a AS (SELECT TOP 100 s.mpr_id,l.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address, s.has_cobroke  FROM SE_Loading.dbo.property_repository S (NOLOCK)  JOIN Property.dataagg.LISTINGS L (nolock)  on s.property_id = l.property_id  and s.state_code = l.state_code  join Property.mls.listings_extended_info e (nolock)  on e.listing_id = l.listing_id  and e.fulfillmentgroup_bitmask  is NULL  JOIN Property.dbo.zips_sold_4_cobroke_connection z4cb (nolock)  ON s.state_code = z4cb.state_code  AND s.zip = z4cb.zip  and z4cb.zip  in (  '00001','00002','00003','00004','00005','00006','00007','00008','00009','00010','00011','00012','00013','00014','00015','00016','00017','00018','00019','00020','01085','01501','07712','07719','08608','08609','08610','08611','08618','08619','08620','08628','08629','08638','08690','08691','08817','08820','08837','11717','11722','12202','12203','12204','12205','12206','12207','12208','12209','12210','12211','12230','12234','19801','19802','19803','19804','19805','19806','19807','19808','19809','19810','20109','20110','20111','20112','20164','20165','20166','22039','22191','22192','22193','24153','28202','28203','28204','28205','28206','28207','28208','28209','28210','28211','28212','28213','28214','28215','28216','28217','28226','28227','28246','28254','28262','28269','28270','28271','28273','28277','28278','28285','28428','28752','29401','29402','29403','29406','29407','29412','29414','29492','29568','29926','29928','30006','30008','30060','30062','30064','30065','30066','30067','30068','30133','30134','30135','30601','30603','30604','30605','30606','30607','30608','33114','33125','33126','33127','33128','33129','33130','33131','33132','33133','33134','33135','33136','33137','33138','33142','33143','33144','33145','33146','33147','33150','33152','33153','33155','33156','33157','33158','33161','33162','33163','33165','33166','33167','33168','33169','33170','33172','33173','33174','33175','33176','33177','33178','33179','33180','33181','33182','33183','33184','33185','33186','33187','33189','33190','33193','33194','33196','33197','33301','33304','33305','33306','33308','33309','33311','33312','33313','33314','33315','33316','33317','33318','33319','33320','33321','33322','33323','33324','33325','33326','33327','33328','33330','33331','33332','33334','33351','33602','33603','33604','33605','33606','33607','33609','33610','33611','33612','33613','33614','33615','33616','33617','33618','33619','33623','33624','33625','33626','33629','33634','33635','33637','33647','33684','34101','34102','34103','34104','34105','34106','34108','34109','34110','34112','34113','34114','34116','34117','34119','34120','34423','34428','34429','34683','34684','34685','36526','36532','36533','36542','36547','36561','38016','38018','43016','43017','44102','44103','44104','44105','44106','44108','44109','44110','44111','44112','44113','44114','44115','44118','44119','44120','44121','44124','44125','44126','44127','44128','44129','44130','44134','44135','44143','44144','44420','46307','46308','46530','46601','46613','46614','46615','46616','46617','46619','46624','46628','46634','46635','46637','46795','48135','50401','54114','60004','60005','60108','60601','60602','60603','60604','60605','60606','60607','60608','60609','60610','60611','60612','60613','60614','60615','60616','60617','60618','60619','60620','60621','60622','60623','60624','60625','60626','60628','60629','60630','60631','60632','60633','60634','60636','60637','60638','60639','60640','60641','60643','60644','60645','60646','60647','60649','60651','60652','60653','60654','60655','60656','60657','60659','60660','60661','75034','75035','77002','77003','77004','77005','77006','77007','77008','77009','77011','77012','77013','77014','77015','77016','77017','77018','77019','77020','77021','77022','77023','77024','77025','77026','77027','77028','77029','77030','77031','77032','77033','77034','77035','77036','77037','77038','77039','77040','77041','77042','77043','77044','77045','77046','77047','77048','77049','77050','77051','77053','77054','77055','77056','77057','77058','77059','77060','77061','77062','77063','77064','77065','77066','77067','77068','77069','77070','77071','77072','77073','77074','77075','77076','77077','77078','77079','77080','77081','77082','77083','77084','77085','77086','77087','77088','77089','77090','77091','77092','77093','77094','77095','77096','77098','77099','77237','78701','78702','78703','78704','78705','78717','78719','78721','78722','78723','78724','78725','78726','78727','78728','78729','78730','78731','78732','78733','78734','78735','78736','78737','78738','78739','78741','78742','78744','78745','78746','78747','78748','78749','78750','78751','78752','78753','78754','78756','78757','78758','78759','78767','81401','81435','85253','85629','85701','85704','85705','85706','85710','85711','85712','85713','85714','85715','85716','85718','85719','85720','85730','85735','85736','85737','85739','85741','85742','85743','85745','85746','85747','85748','85749','85750','85755','85757','86301','86303','86305','87102','87103','87104','87105','87106','87107','87108','87109','87110','87111','87112','87113','87114','87120','87121','87122','87123','88201','88203','88310','89101','89102','89103','89104','89106','89107','89108','89109','89110','89113','89115','89116','89117','89118','89119','89120','89121','89122','89123','89124','89128','89129','89130','89131','89134','89135','89136','89138','89139','89141','89142','89143','89144','89145','89146','89147','89148','89149','89155','89156','89161','89166','89170','89178','89179','89193','90001','90002','90003','90004','90005','90006','90007','90008','90010','90011','90012','90013','90014','90015','90016','90017','90018','90019','90020','90021','90022','90023','90024','90025','90026','90027','90028','90029','90031','90032','90033','90034','90035','90036','90037','90038','90039','90040','90041','90042','90043','90044','90045','90046','90047','90048','90049','90056','90057','90058','90059','90061','90062','90063','90064','90065','90066','90067','90068','90077','90082','90094','90265','90802','90803','90804','90805','90806','90807','90808','90810','90813','90814','90815','91301','91302','91303','91304','91306','91311','91316','91320','91324','91325','91326','91331','91342','91344','91360','91362','91364','91367','91401','91405','91406','91411','91436','92307','92308','92392','92394','92395','92401','92404','92405','92407','92408','92410','92411','92501','92503','92504','92505','92506','92507','92508','92509','92590','92591','92592','92630','93010','93012','93020','93021','93063','93065','94002','94061','94062','94063','94065','94920','94941','96811','96813','96814','96815','96816','96817','96818','96819','96821','96822','96825','96826','96844','98004','98005','98006','98007','98008','98015','99201','99202','99203','99204','99205','99206','99207','99208','99209','99212','99213','99216','99217','99218','99220','99223','99224','99228','99252','99501','99502','99503','99504','99507','99508','99515','99516','99517','99518','99577','99654','99669','99687','99701','99707','99708','99709','99712','99801'  )  WHERE s.city IN ('BinderSix','Binder')  and s.se_deleted = 0  and l.listing_status_id = 1  and s.property_status = 'For Sale'  AND s.has_cobroke = 1  and l.source_alias_id not like 'PROD%'  ) SELECT TOP 1 a.* FROM a  Order by NEWID ()
TCM8596,WITH a AS (SELECT TOP 1000 s.mpr_id,l.source_alias_id, (l.address_line + ', '+l.city+', '+ l.state_code+', '+ l.zip) as Address FROM Property.dataagg.listings l(NOLOCK) Join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id and e.fulfillmentgroup_bitmask is not NULL inner JOIN NewHome.nh.mapping_of_subdivision_plan_property nhp (NOLOCK) ON l.property_id = nhp.property_id where L.agreement_id = 1 and l.listing_status_id = 1 and s.address_line is not null and s.address_line >'%'  and s.zip is not null and l.source_alias_id is not NULL and l.property_id >0 and s.property_status = 'For Sale') SELECT TOP 1 a.* FROM a Order by NEWID ()
TCM8593_4,select LeadID from Lead.LEAD where Firstname = $$FirstName$$
TCM8593_5,WITH a AS ( SELECT top 1000 s.mpr_id,l.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id and e.fulfillmentgroup_bitmask  in ('3072') where l.agreement_id = 1 and l.listing_status_id = 1 and s.city IN ('BinderSix','Binder') and s.property_status = 'For Sale' and s.address_line like '%simulation%' ) SELECT top 1 a.* FROM a Order by NEWID ()
TCM8593_6,WITH a AS ( SELECT top 1000 s.mpr_id,l.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id and e.fulfillmentgroup_bitmask  in ('3072') where l.agreement_id = 1 and l.listing_status_id = 1 and s.city IN ('BinderSix','Binder') and s.property_status = 'For Sale' and s.address_line like '%TESTING%' ) SELECT top 1 a.* FROM a Order by NEWID ()
TCM8300_FS_MprId,With a as ( select top 10 s.mpr_id, s.address_line, s.city, s.state_code, s.zip from SE_Loading.dbo.property_repository s (nolock) join Property.dbo.zips_sold_4_cobroke_connection z4cb ON s.state_code = z4cb.state_code AND s.zip = z4cb.zip WHERE s.se_deleted = 0 AND s.property_status = 'For Sale' AND s.has_cobroke=1 ) SELECT TOP 1 a.* FROM a Order by NEWID()
TCM8344_FR_MprId,With a as ( select top 100 s.mpr_id, s.address_line, s.city, s.state_code, s.zip from SE_Loading.dbo.property_repository s (nolock) join Property.dbo.zips_sold_4_cobroke_connection z4cb ON s.state_code = z4cb.state_code AND s.zip = z4cb.zip WHERE s.se_deleted = 0 AND s.property_status = 'For Rent' AND s.has_cobroke=1 ) SELECT TOP 1 a.* FROM a Order by NEWID()
TCM8345_RS_MprId,With a as ( select top 100 s.mpr_id, s.address_line, s.city, s.state_code, s.zip from SE_Loading.dbo.property_repository s (nolock) join Property.dbo.zips_sold_4_cobroke_connection z4cb ON s.state_code = z4cb.state_code AND s.zip = z4cb.zip WHERE s.se_deleted = 0 AND s.property_status = 'Recently Sold' AND s.has_cobroke=1 ) SELECT TOP 1 a.* FROM a Order by NEWID()
TCM8696_NFS_MprId,WITH a AS (SELECT TOP 50 s.mpr_id,(L.address_line + ', '+L.city+', '+ L.state_code+', '+ L.zip) as Address from SE_Loading.dbo.property_repository s (nolock) join Property.dataagg.listings l  (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.property_status = 'Off market' and l.listing_status_id = 7 and l.agreement_id = 1 and s.se_deleted =0) SELECT TOP 1 a.* FROM a Order by NEWID ()
DBVal_RomPara,SELECT  lt.text_data FROM property.dataagg.listing_attributes la (NOLOCK)  JOIN property.dataagg.listings l (NOLOCK) ON la.listing_id = l.listing_id  JOIN SE_Loading.dbo.property_repository se (nolock) on l.property_id = se.property_id LEFT OUTER JOIN property.mls.listing_text lt (NOLOCK) ON l.listing_id = lt.listing_id WHERE l.agreement_id =1 and l.property_id >0  and se.se_deleted = 0   and l.listing_status_id = 1   and la.attribute_id =110  and  se.mpr_id = $$MprId$$
DBVal_ProDetail,Select d.nbr_bedroom,d.nbr_bathroom,d.listing_sqft,d.lot_sqft,d.listing_price,s.property_type,d.year_built,d.house_nbr,d.style,d.raw_status,d.county,d.source_alias_id,s.property_price from [Property].[dataagg].[listings] d (nolock) join [SE_Loading].[dbo].[property_repository] s (nolock) on d.property_id = s.property_id where s.mpr_id='$$MprId$$' and d.agreement_id='$$AgreementId$$' and d.source_alias_id='$$MlsId$$'
DBVal_ProDetail_New,Select d.nbr_bedroom,d.nbr_bathroom,d.listing_sqft,d.lot_sqft,d.listing_price,s.property_type,d.year_built,d.house_nbr,d.style,d.raw_status,d.county,d.source_alias_id,s.property_price,s.listing_date from [Property].[dataagg].[listings] d (nolock) join [SE_Loading].[dbo].[property_repository] s (nolock) on d.property_id = s.property_id where s.mpr_id='$$MprId$$' and d.agreement_id='$$AgreementId$$' and d.raw_status='Active' and s.property_status='For sale' and d.listing_status_id=1
DBVal_AttrId,SELECT  top 1 attribute_id FROM Property.dataagg.master_listing_attributes Where common_code='$$Common_Code$$'
DBVal_AttrVal,Select la.attribute_value  from property.dataagg.listing_attributes la (nolock) join property.dataagg.listings l (nolock) on la.listing_id= l.listing_id join SE_Loading.dbo.property_repository s(nolock) on l.property_id=s.property_id  and l.state_code = s.state_code where l.source_alias_id='$$MlsId$$' and l.agreement_id='$$AgreementId$$' and la.attribute_id='$$AttrId$$'
TCM8609_MprId, SELECT TOP 1 s.mpr_id FROM Property.dataagg.listings l(NOLOCK) INNER JOIN property.dataagg.offices o (NOLOCK) ON l.datasource_id = o.datasource_id Join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id Join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where e.fulfillmentgroup_bitmask is NULL and l.zip = '00011' and agreement_id = 1 and l.listing_status_id = 1 and l.property_id >0 and s.property_status = 'For Sale' AND EXISTS ( SELECT TOP 1 1 FROM Property.dataagg.listing_agent_parties la (NOLOCK) WHERE la.listing_id = l.listing_id AND o.office_id = la.office_id )
TCM8610_MprId, SELECT TOP 1 s.mpr_id FROM Property.dataagg.listings l(NOLOCK) INNER JOIN property.dataagg.offices o (NOLOCK) ON l.datasource_id = o.datasource_id Join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id Join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where e.fulfillmentgroup_bitmask is NULL and l.zip = '00011' and agreement_id = 1 and l.listing_status_id = 1 and l.property_id >0 and s.property_status = 'For Sale' AND EXISTS ( SELECT TOP 1 1 FROM Property.dataagg.listing_agent_parties la (NOLOCK) WHERE la.listing_id = l.listing_id AND o.office_id = la.office_id )
For Sale_Address,"WITH a AS ( SELECT TOP 1000 s.mpr_id,l.source_alias_id,(L.address_line + ', '+L.city+', '+ L.state_code+', '+ L.zip) as Address from SE_Loading.dbo.property_repository s (nolock) join Property.dataagg.listings l (nolock) on l.property_id = s.property_id and l.state_code = s.state_code and s.state_code = 'NV' where s.property_status = 'For Sale' and s.fulfillmentgroup_id like '%8%' and l.agreement_id = 1 and s.se_deleted = 0) SELECT TOP 1 a.* FROM a Order by NEWID();"
FSShowcaseVideo_MprId,With a as(SELECT TOP 10 s.mpr_id,has_virtual_tour, has_video FROM SE_Loading.dbo.property_repository s(nolock)WHERE se_deleted = 0 AND property_status = 'for sale'AND has_video = 1)SELECT Top 1 a.* FROM a Order by NEWID();
FSShowcaseTour_MprId,With a as(SELECT TOP 10 s.mpr_id,has_virtual_tour, has_video FROM SE_Loading.dbo.property_repository s(nolock) WHERE se_deleted = 0 AND property_status = 'for sale' AND has_virtual_tour =1)SELECT Top 1 a.* FROM a Order by NEWID(); 
FRShowcaseTour_MprId,With a as(SELECT TOP 10 s.mpr_id FROM SE_Loading.dbo.property_repository s(nolock) WHERE se_deleted = 0 AND property_status = 'for rent' AND has_virtual_tour =1)SELECT Top 1 a.* FROM a Order by NEWID();
FSShowcase_MprId_Old,WITH a AS ( SELECT top 1000 s.mpr_id from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask in ('2048') and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.source_alias_id like 'PROD%') SELECT top 1 a.* FROM a Order by NEWID ();
FSShowcase_MprId_Old2,WITH a AS ( SELECT top 1000 s.mpr_id from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask in ('2048') and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.raw_status='Active') SELECT top 1 a.* FROM a Order by NEWID ();
FSShowcase_MprId,WITH a AS ( SELECT top 100 s.mpr_id , A.EMAIL from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id Join Property.dataagg.listing_agent_parties la (nolock) on l.listing_id = la.listing_id join Property.dataagg.agents a on a.agent_id=la.agent_id where e.fulfillmentgroup_bitmask in ('2048') and a.email is not NULL and s.mpr_id != '2063869294' and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_type!='Land' and s.property_status = 'For Sale' and l.raw_status='Active') SELECT top 1 a.* FROM a Order by NEWID ();
FRShowcase_MprId,WITH a AS ( SELECT top 100 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'For Rent' and l.state_code not in ('NULL','')) SELECT top 1 a.* FROM a Order by NEWID ();
FRShowcase_MprId_OLD3,WITH a AS ( SELECT top 100 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address, A.EMAIL from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id Join Property.dataagg.listing_agent_parties la (nolock) on l.listing_id = la.listing_id join Property.dataagg.agents a on a.agent_id=la.agent_id where e.fulfillmentgroup_bitmask = '2048' and a.email is not NULL and l.agreement_id = 1 and l.listing_status_id = 6 and l.source_alias_id is not NULL and s.property_status = 'For Rent')SELECT top 1 a.* FROM a Order by NEWID ();
FRShowcase_MprId_Old2,WITH a AS ( SELECT top 100 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask = '2048' and l.agreement_id = 1 and l.listing_status_id = 6 and l.source_alias_id is not NULL and s.property_status = 'For Rent')SELECT top 1 a.* FROM a Order by NEWID ();
FRShowcase_MprId_Old,WITH a AS ( SELECT top 100 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask = '2048' and l.agreement_id = 1 and l.listing_status_id = 6 and l.source_alias_id is not NULL and s.property_status = 'For Rent' and l.source_alias_id like 'PROD%' )SELECT top 1 a.* FROM a Order by NEWID ();
FSOffceShowcase_MprId,WITH a AS ( SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address, A.EMAIL from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id Join Property.dataagg.listing_agent_parties la (nolock) on l.listing_id = la.listing_id join Property.dataagg.agents a on a.agent_id=la.agent_id where e.fulfillmentgroup_bitmask in ('16','256','2048') and a.email is not NULL and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.source_alias_id like 'PROD%' )SELECT top 1 a.* FROM a Order by NEWID ();
FSOffceShowcase_MprId_Old,WITH a AS ( SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask in ('16','256','2048') and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.source_alias_id like 'PROD%' )SELECT top 1 a.* FROM a Order by NEWID ();
FSOffceStandard_MprId,WITH a AS ( SELECT top 1000 s.mpr_id,l.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask = '64' and s.property_status = 'For Sale') SELECT TOP 1 a.* FROM a Order by NEWID ();
FSCobroke_MprId,WITH a AS (  SELECT TOP 100 s.mpr_id,l.source_alias_id, s.has_cobroke, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address FROM SE_Loading.dbo.property_repository S (NOLOCK) JOIN Property.dataagg.LISTINGS L (nolock) on s.property_id = l.property_id and s.state_code = l.state_code and s.se_deleted = 0 and l.listing_status_id = 1 and s.property_status = 'For Sale'  AND s.has_cobroke = 1 and l.source_alias_id like 'PROD%' ) SELECT TOP 1 a.* FROM a Order by NEWID ();
FSAgentShowcase_MprId,WITH a AS ( SELECT top 100 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address, A.EMAIL from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id Join Property.dataagg.listing_agent_parties la (nolock) on l.listing_id = la.listing_id join Property.dataagg.agents a on a.agent_id=la.agent_id where e.fulfillmentgroup_bitmask = '2048' and a.email is not NULL and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.source_alias_id like 'PROD%' )SELECT top 1 a.* FROM a Order by NEWID ();
FSAgentShowcase_MprId_Old,WITH a AS ( SELECT top 100 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask = '2048' and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.source_alias_id like 'PROD%' )SELECT top 1 a.* FROM a Order by NEWID ();
FS_PropAddress_Not_Available,SELECT top 10 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.keyword_blob LIKE 'Public Address Y/N|^N|%' AND L.listing_status_id = 1
BinderFSShowcase_MprId,WITH a AS (SELECT top 10 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask !='0' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') AND l.city like 'Binder%') SELECT top 1 a.* FROM a Order by NEWID ();
BinderFSShowcase_MprId_Old,WITH a AS( SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask in ('2048') and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale'and l.state_code not in ('NULL','') and l.city='Binder' and l.state_code='CA') SELECT top 1 a.* FROM a Order by NEWID ()
OldTCM8593_1,select top 10 lr.statusid,lr.recipient,ls.StatusID from xLeads.dbo.lead_recipient lr,xLeads.lead.lead ll,xLeads.Lead.Status ls with (nolock) where ls.leadid = ll.leadid and lr.leadid = ll.leadid and ll.firstname = $$FirstName$$ 
OldTCM8593_2,select top 10 StatusID,Recipient from dbo.lead_recipient with (nolock) where leadid = $$LeadID$$

******************Below Set of Queries Added By Madhu On 09/10/2013*************************************************************************************
FS_BASIC,WITH a AS ( SELECT top 10 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.source_alias_id like 'PROD%' )SELECT top 1 a.* FROM a Order by NEWID ()
FS_COBROKE,WITH a AS (  SELECT TOP 10 s.mpr_id,l.source_alias_id, s.has_cobroke, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address FROM SE_Loading.dbo.property_repository S (NOLOCK) JOIN Property.dataagg.LISTINGS L (nolock) on s.property_id = l.property_id and s.state_code = l.state_code and s.se_deleted = 0 and l.listing_status_id = 1 and s.property_status = 'For Sale'  AND s.has_cobroke = 1 and l.source_alias_id like 'PROD%' ) SELECT TOP 1 a.* FROM a Order by NEWID ()
FS_OFFICESTANDARD,WITH a AS ( SELECT top 10 s.mpr_id,l.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask = '64'and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale') SELECT TOP 1 a.* FROM a Order by NEWID ()
FS_AGENTSHOWCASE,WITH a AS ( SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip)as Address, A.EMAIL from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock)on e.listing_id = l.listing_id Join Property.dataagg.listing_agent_parties la (nolock) on l.listing_id = la.listing_id join Property.dataagg.agents a on a.agent_id=la.agent_id where e.fulfillmentgroup_bitmask = '2048' and a.email is not NULL and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.source_alias_id is not Null and l.city <> 'Binder%')SELECT top 1 a.* FROM a Order by NEWID (); 
FS_AGENTSHOWCASE_Old1,WITH a AS ( SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address, A.EMAIL from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id Join Property.dataagg.listing_agent_parties la (nolock) on l.listing_id = la.listing_id join Property.dataagg.agents a on a.agent_id=la.agent_id where e.fulfillmentgroup_bitmask = '2048' and a.email is not NULL and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.source_alias_id like 'PROD%' )SELECT top 1 a.* FROM a Order by NEWID ();
FS_AGENTSHOWCASE_Old,WITH a AS ( SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask = '2048' and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.source_alias_id like 'PROD%' )SELECT top 1 a.* FROM a Order by NEWID ();
FS_OFFICESHOWCASE,WITH a AS ( SELECT top 10 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address, A.EMAIL from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id Join Property.dataagg.listing_agent_parties la (nolock) on l.listing_id = la.listing_id join Property.dataagg.agents a on a.agent_id=la.agent_id where e.fulfillmentgroup_bitmask in ('16','256','2048') and a.email is not NULL and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.source_alias_id like 'PROD%' )SELECT top 1 a.* FROM a Order by NEWID ()
FS_OFFICESHOWCASE_Old,WITH a AS ( SELECT top 10 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask in ('16','256','2048') and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.source_alias_id like 'PROD%' )SELECT top 1 a.* FROM a Order by NEWID ()
FS_CDP,
FS_FORCLOSURES,
FS_PDP,
FS_BASIC_ADDRESS,WITH a AS ( SELECT top 10 (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.source_alias_id like 'PROD%' )SELECT top 1 a.* FROM a Order by NEWID ()
FS_BASIC_MLSID,WITH a AS ( SELECT top 10 L.source_alias_id from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.source_alias_id like 'PROD%' )SELECT top 1 a.* FROM a Order by NEWID ()

FR_Basic,WITH a AS ( SELECT top 10 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and l.listing_status_id = 6 and l.source_alias_id is not NULL and s.property_status = 'For Rent' and l.source_alias_id like 'PROD%' )SELECT top 1 a.* FROM a Order by NEWID ()
FR_COBROKE,WITH a AS (  SELECT TOP 10 s.mpr_id,l.source_alias_id, s.has_cobroke, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address FROM SE_Loading.dbo.property_repository S (NOLOCK) JOIN Property.dataagg.LISTINGS L (nolock) on s.property_id = l.property_id and s.state_code = l.state_code and s.se_deleted = 0 and l.listing_status_id = 6 and s.property_status = 'For Sale'  AND s.has_cobroke = 1 and l.source_alias_id like 'PROD%' ) SELECT TOP 1 a.* FROM a Order by NEWID ()
FR_OFFICESTANDARD,WITH a AS ( SELECT top 10 s.mpr_id,l.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask = '64'and l.agreement_id = 1 and l.listing_status_id = 6 and l.source_alias_id is not NULL and s.property_status = 'For Rent') SELECT TOP 1 a.* FROM a Order by NEWID ()
FR_AGENTSHOWCASE,WITH a AS ( SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address, A.EMAIL from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id Join Property.dataagg.listing_agent_parties la (nolock) on l.listing_id = la.listing_id join Property.dataagg.agents a on a.agent_id=la.agent_id where e.fulfillmentgroup_bitmask = '2048' and a.email is not NULL and l.agreement_id = 1 and l.listing_status_id = 6 and l.source_alias_id is not NULL and s.property_status = 'For Rent' and l.source_alias_id like 'PROD%' )SELECT top 1 a.* FROM a Order by NEWID ();
FR_AGENTSHOWCASE_Old,WITH a AS ( SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask = '2048' and l.agreement_id = 1 and l.listing_status_id = 6 and l.source_alias_id is not NULL and s.property_status = 'For Rent' and l.source_alias_id like 'PROD%' )SELECT top 1 a.* FROM a Order by NEWID ();
FR_OFFICESHOWCASE,WITH a AS ( SELECT top 10 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address, A.EMAIL from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id Join Property.dataagg.listing_agent_parties la (nolock) on l.listing_id = la.listing_id join Property.dataagg.agents a on a.agent_id=la.agent_id where e.fulfillmentgroup_bitmask in ('16','256','2048') and a.email is not NULL and l.agreement_id = 1 and l.listing_status_id = 6 and l.source_alias_id is not NULL and s.property_status = 'For Rent' and l.source_alias_id like 'PROD%' )SELECT top 1 a.* FROM a Order by NEWID ()
FR_OFFICESHOWCASE_Old,WITH a AS ( SELECT top 10 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask in ('16','256','2048') and l.agreement_id = 1 and l.listing_status_id = 6 and l.source_alias_id is not NULL and s.property_status = 'For Rent' and l.source_alias_id like 'PROD%' )SELECT top 1 a.* FROM a Order by NEWID ()
FR_CDP,
FR_FORCLOSURES,
FR_PDP,
FR_Basic_MLSID,WITH a AS ( SELECT top 10  L.source_alias_id from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and l.listing_status_id = 6 and l.source_alias_id is not NULL and s.property_status = 'For Rent' and l.source_alias_id like 'PROD%' )SELECT top 1 a.* FROM a Order by NEWID ()
FR_Basic_ADDRESS,WITH a AS ( SELECT top 10 (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and l.listing_status_id = 6 and l.source_alias_id is not NULL and s.property_status = 'For Rent' and l.source_alias_id like 'PROD%' )SELECT top 1 a.* FROM a Order by NEWID ()

NFS_BASIC,WITH a AS ( SELECT top 10 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and l.listing_status_id = 7 and l.source_alias_id is not NULL and s.property_status = 'Not For Sale' and l.source_alias_id like 'PROD%' )SELECT top 1 a.* FROM a Order by NEWID ()
NFS_BAISC_MLSID,WITH a AS ( SELECT top 10 L.source_alias_id from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and l.listing_status_id = 7 and l.source_alias_id is not NULL and s.property_status = 'Not For Sale' and l.source_alias_id like 'PROD%' )SELECT top 1 a.* FROM a Order by NEWID ()
NFS_BAISC_ADDRESS,WITH a AS ( SELECT top 10 (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and l.listing_status_id = 4 and l.source_alias_id is not NULL and s.property_status = 'Not For Sale' and l.source_alias_id like 'PROD%' )SELECT top 1 a.* FROM a Order by NEWID ()


RS_Basic,WITH a AS ( SELECT top 10 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and l.listing_status_id = 7 and l.source_alias_id is not NULL and s.property_status = 'Recently Sold' and l.source_alias_id like 'PROD%' )SELECT top 1 a.* FROM a Order by NEWID ()
RS_BAISC_MLSID,WITH a AS ( SELECT top 10 L.source_alias_id from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and l.listing_status_id = 7 and l.source_alias_id is not NULL and s.property_status = 'Recently Sold' and l.source_alias_id like 'PROD%' )SELECT top 1 a.* FROM a Order by NEWID ()
RS_BAISC_ADDRESS,WITH a AS ( SELECT top 10 (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and l.listing_status_id = 4 and l.source_alias_id is not NULL and s.property_status = 'Recently Sold' and l.source_alias_id like 'PROD%' )SELECT top 1 a.* FROM a Order by NEWID ()

FS_BASIC_NonLead,WITH a AS ( SELECT top 10 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale'and l.city='Denver' )SELECT top 1 a.* FROM a Order by NEWID ()
FR_BASIC_NonLead,WITH a AS ( SELECT top 10 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and l.listing_status_id = 6 and l.source_alias_id is not NULL and s.property_status = 'For Rent' and l.city='Austin')SELECT top 1 a.* FROM a Order by NEWID ()
NFS_BASIC_NonLead,WITH a AS ( SELECT top 10 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and l.listing_status_id = 6 and l.source_alias_id is not NULL and s.property_status = 'Off market' and l.city='Austin')SELECT top 1 a.* FROM a Order by NEWID ()
RS_BASIC_NonLead,WITH a AS ( SELECT top 10 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and l.listing_status_id = 6 and l.source_alias_id is not NULL and s.property_status = 'Recently Sold' and l.city='Denver')SELECT top 1 a.* FROM a Order by NEWID ()
FS_Showcase_NonLead,WITH a AS ( SELECT top 1000 s.mpr_id, s.city from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask in ('2048') and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.city <> 'binder') SELECT top 1 a.* FROM a Order by NEWID ();
FR_Showcase_NonLead,WITH a AS ( SELECT top 1000 s.mpr_id, s.city from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask in ('64') and l.agreement_id = 1 and l.listing_status_id = 6 and l.source_alias_id is not NULL and s.property_status = 'For Rent' and l.city <> 'binder') SELECT top 1 a.* FROM a Order by NEWID ();
FS_AGENTSHOWCASE_NonLead,WITH a AS ( SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask = '2048' and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.city <> 'binder' )SELECT top 1 a.* FROM a Order by NEWID ();
FS_OFFICESHOWCASE_NonLead,WITH a AS ( SELECT top 10 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask in ('16','256','2048') and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.city <> 'binder')SELECT top 1 a.* FROM a Order by NEWID ()
FS_OFFICESTANDARD_NonLead,WITH a AS ( SELECT top 10 s.mpr_id,l.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask = '64'and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.city <> 'binder') SELECT TOP 1 a.* FROM a Order by NEWID ()
FS_COBROKE_NonLead,WITH a AS (  SELECT TOP 10 s.mpr_id,l.source_alias_id, s.has_cobroke, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address FROM SE_Loading.dbo.property_repository S (NOLOCK) JOIN Property.dataagg.LISTINGS L (nolock) on s.property_id = l.property_id and s.state_code = l.state_code and s.se_deleted = 0 and l.listing_status_id = 1 and s.property_status = 'For Sale'  AND s.has_cobroke = 1 and l.city <> 'binder' ) SELECT TOP 1 a.* FROM a Order by NEWID ()
FR_BASIC_HOUSESCONDOS, WITH a AS (  SELECT top 10 s.mpr_id, (l.address_line + ' ' +  l.city + ' ' + l.state_code + ' ' + l.zip) as Address, l.listing_status_id, l.city, l.state_code, l.source_alias_id FROM dataagg.listings AS l (NOLOCK) JOIN dbo.zips_sold_4_cobroke_connection AS cb (NOLOCK) ON l.zip = cb.zip join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id  join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id  and l.state_code = s.state_code WHERE l.agreement_id = 1 AND datasource_id >0 and s.property_status = 'For rent') SELECT TOP 1 a.* FROM a Order by NEWID () 

******************************Till Here:Madhu On 09/10/2013**********************************************************

FS_MprId,With a as ( select top 10 s.mpr_id  from SE_Loading.dbo.property_repository s (nolock) join Property.dbo.zips_sold_4_cobroke_connection z4cb ON s.state_code = z4cb.state_code AND s.zip = z4cb.zip WHERE s.se_deleted = 0 AND s.property_status = 'For Sale' AND s.has_cobroke=1 AND s.state_code = 'CA' AND s.city='Binder') SELECT TOP 1 a.* FROM a Order by NEWID()
FR_MprId,With a as ( select top 10 s.mpr_id from SE_Loading.dbo.property_repository s (nolock) join Property.dbo.zips_sold_4_cobroke_connection z4cb ON s.state_code = z4cb.state_code AND s.zip = z4cb.zip WHERE s.se_deleted = 0 AND s.property_status = 'For Rent' AND s.has_cobroke=1  AND s.state_code = 'CA' AND s.city='Binder') SELECT TOP 1 a.* FROM a Order by NEWID()
RS_MprId,With a as ( select top 10 s.mpr_id from SE_Loading.dbo.property_repository s (nolock) join Property.dbo.zips_sold_4_cobroke_connection z4cb ON s.state_code = z4cb.state_code AND s.zip = z4cb.zip WHERE s.se_deleted = 0 AND s.property_status = 'Recently Sold' AND s.has_cobroke=1 ) SELECT TOP 1 a.* FROM a Order by NEWID()
NFS_MprId,WITH a AS (SELECT TOP 10 s.mpr_id  from SE_Loading.dbo.property_repository s (nolock) join Property.dataagg.listings l  (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.property_status = 'Off market' and l.listing_status_id = 7 and l.agreement_id = 1 and s.se_deleted =0  AND s.state_code = 'CA' AND s.city='Binder') SELECT TOP 1 a.* FROM a Order by NEWID ()

*********************************************TEENA NON-BINDER QUERIES 02112014************************************************
FS_BASICNB,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') AND l.city not like 'Binder%') SELECT top 1 a.* FROM a Order by NEWID ()
FS_OFFICEAGENTSHOWNB_OLD,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask in ('2048') and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') and l.city not like 'binder%') SELECT top 1 a.* FROM a Order by NEWID ()
FS_OFFICEAGENTSHOWNB,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask in ('3072') and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') and l.city not like 'binder%') SELECT top 1 a.* FROM a where Address is not null Order by NEWID ()
FS_AGENTSHOWNB,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask in ('128') and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') and l.city not like 'binder%') SELECT top 1 a.* FROM a Order by NEWID ()
FS_OFFICESHOWNB_New,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask in ('3072') and l.agreement_id = 1 and s.se_deleted = 0 and s.selling_agent_advertiser_id = '93627' and s.selling_office_advertiser_id='26269' and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') and l.city not like 'binder%') SELECT top 10 a.* FROM a Order by NEWID ()
FS_OFFICESHOWNB,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask in ('3072') and l.agreement_id = 1 and s.se_deleted = 0 and s.selling_agent_advertiser_id = '919670' and s.selling_office_advertiser_id='1542036' and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') and l.city not like 'binder%') SELECT top 10 a.* FROM a where Address is not null Order by NEWID()
FS_COBROKENB_OLD,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address FROM Property.dataagg.listings l (nolock) JOIN SE_Loading.dbo.property_repository (NOLOCK) s on l.property_id = s.property_id and l.state_code = s.state_code JOIN Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id JOIN Property.dbo.zips_sold_4_cobroke_connection z4cb ON s.state_code = z4cb.state_code AND s.zip = z4cb.zip and z4cb.zip in ('85629','85622','85635','85636','85650','85658') where e.fulfillmentgroup_bitmask not in ('527360','7168','67116032','4224','67111936','100666368','67108992','3072','33557504','128','2048') and e.fulfillmentgroup_bitmask in ('536870912') AND l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') and l.city not like 'binder%' and s.has_cobroke = 1) SELECT TOP 1 a.* FROM a Order by NEWID ()
FS_COBROKENB,WITH a AS (SELECT top 10 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address FROM Property.dataagg.listings l (nolock) JOIN SE_Loading.dbo.property_repository (NOLOCK) s on l.property_id = s.property_id and l.state_code = s.state_code JOIN Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id JOIN Property.dbo.zips_sold_4_cobroke_connection z4cb ON s.state_code = z4cb.state_code AND s.zip = z4cb.zip and z4cb.zip in ('93012','99504','70118') where l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') and l.city not like 'binder%' and s.has_cobroke = 1) SELECT TOP 1 a.* FROM a Order by NEWID ()
FS_C21NB,WITH a AS (SELECT TOP 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address FROM Property.dataagg.listings l(NOLOCK) INNER JOIN property.dataagg.offices o (NOLOCK) ON l.datasource_id = o.datasource_id Join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id Join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where e.fulfillmentgroup_bitmask is not NULL and l.city not IN ('Binder', 'Binder Six', 'Binder%') and agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.property_id >0 and s.property_status = 'For Sale' AND EXISTS (SELECT TOP 1 1 FROM Property.dataagg.listing_agent_parties la (NOLOCK) WHERE la.listing_id = l.listing_id AND o.office_id = la.office_id) AND o.office_name LIKE '%21%') SELECT TOP 1 a.* FROM a Order by NEWID ()
FS_FORECLOSURESNB,WITH a AS (Select top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from property.dataagg.listings l (nolock) join property.dataagg.listing_attributes a (nolock) on l.listing_id = a.listing_id join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where a.attribute_id = 3 and a.attribute_value ='Foreclosed' and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL) SELECT top 1 a.* FROM a Order by NEWID ()
FR_BASICNB,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask ='0' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'For Rent' and l.state_code not in ('NULL','') AND l.city not like 'Binder%') SELECT top 1 a.* FROM a Order by NEWID ()
FR_SHOWCASENB,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask !='0' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'For Rent' and l.state_code not in ('NULL','') AND l.city not like 'Binder%') SELECT top 1 a.* FROM a Order by NEWID ()
RS_BASICNB,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask ='0' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'Recently Sold' and l.state_code not in ('NULL','') AND l.city not like 'Binder%') SELECT top 1 a.* FROM a Order by NEWID () 
RS_SHOWCASENB,WITH a AS (SELECT top 100 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask !='0' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'Recently Sold' and l.state_code not in ('NULL','') AND l.city not like 'Binder%') SELECT top 1 a.* FROM a Order by NEWID ()
NFS_BASICNB,WITH a AS (SELECT top 100 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and s.sold_date < dateadd( dd, -730, convert(varchar,getdate(),112)) and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'Off market' and l.state_code not in ('NULL','') AND l.city not like 'Binder%') SELECT top 1 a.* FROM a Order by NEWID ()
NH_SHOWCASENB,WITH a AS (SELECT TOP 1000 s.mpr_id,l.source_alias_id, (l.address_line + ', '+l.city+', '+ l.state_code+', '+ l.zip) as Address FROM Property.dataagg.listings l(NOLOCK) INNER JOIN NewHome.nh.mapping_of_subdivision_plan_property b (NOLOCK) ON l.property_id = b.property_id Join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id and e.fulfillmentgroup_bitmask is not NULL where l.state_code not in ('NULL','') AND l.city not like 'Binder%' AND L.agreement_id = 1 and l.listing_status_id = 1 and s.address_line is not null and s.address_line >'%' and s.zip is not null and l.source_alias_id is not NULL and l.property_id >0 and s.property_status = 'For sale|?New Construction') SELECT TOP 1 a.* FROM a Order by NEWID ()

************************************************************************************************************************
FS_Add,WITH a AS (SELECT top 10  (s.address_line + ', '+s.city+', '+ s.state_code+' '+s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and s.address_line not like '%#%' and s.address_line not like '%-%'and s.address_line not like '%unit%' and s.address_line like '[1-9]%' ) SELECT top 1 a.* FROM a Order by NEWID ()
FS_MlsId,WITH a AS (SELECT top 10 source_alias_id from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') AND l.city not like 'Binder%') SELECT top 1 a.* FROM a Order by NEWID ()
NFS_Add_OLD,WITH a AS (SELECT top 10 (s.address_line + ', '+s.city+', '+ s.state_code) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and s.sold_date <'1/1/2010 12:00:00 AM' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'Off market' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and s.address_line not like '%#%' and s.address_line not like '%-%'and s.address_line not like '%unit%') SELECT top 1 a.* FROM a Order by NEWID ()
NFS_Add,WITH a AS (SELECT top 10 (s.address_line + ', '+s.city+', '+ s.state_code +', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'Off market' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and s.address_line not like '%#%' and s.address_line not like '%-%'and s.address_line not like '%unit%') SELECT top 1 a.* FROM a Order by NEWID ()
NFS_MlsId,WITH a AS (SELECT top 10  L.source_alias_id from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and s.sold_date <'1/1/2010 12:00:00 AM' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'Off market' and l.state_code not in ('NULL','') AND l.city not like 'Binder%') SELECT top 1 a.* FROM a Order by NEWID ()
RS_Add,WITH a AS (SELECT top 10  (s.address_line + ', '+s.city+', '+ s.state_code +', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask ='0' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'Recently Sold' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and s.address_line not like '%#%' and s.address_line not like '%-%'and s.address_line not like '%unit%') SELECT top 1 a.* FROM a Order by NEWID ()
RS_MlsId,WITH a AS (SELECT top 10  L.source_alias_id from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask ='0' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'Recently Sold' and l.state_code not in ('NULL','') AND l.city not like 'Binder%') SELECT top 1 a.* FROM a Order by NEWID ()
FR_Add,WITH a AS (SELECT top 100 (s.address_line + ', ' + s.city + ', ' + s.state_code + ', ' + s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask ='0' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'For Rent' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and s.address_line not like '%#%' and s.address_line not like '%-%'and s.address_line not like '%unit%') SELECT top 1 a.* FROM a Order by NEWID ()
FR_MlsId,WITH a AS (SELECT top 10 L.source_alias_id from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask ='0' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'For Rent' and l.state_code not in ('NULL','') AND l.city not like 'Binder%') SELECT top 1 a.* FROM a Order by NEWID ()
PhotoCount,Select top 10 l.listing_id,l.address_line, l.city, l.state_code, l.zip ,COUNT( * ) as 'Total Photo' from Property.dataagg.listing_media m (nolock) join Property.dataagg.listings l (nolock)  on l.listing_id = m.listing_id and l.agreement_id = 1 and l.city = '$$City$$' and l.state_code = '$$State$$' and l.address_line like '$$AddressLine$$%' and l.zip = '$$ZipCode$$' group by l.listing_id, l.address_line, l.city, l.state_code, l.zip


NH_SHOWCASE,WITH a AS ( SELECT TOP 10 s.mpr_id,l.source_alias_id, (l.address_line + ', '+l.city+', '+ l.state_code+', '+ l.zip) as Address FROM Property.dataagg.listings l(NOLOCK) INNER JOIN NewHome.nh.mapping_of_subdivision_plan_property b (NOLOCK) ON l.property_id = b.property_id Join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id and e.fulfillmentgroup_bitmask is not NULL where L.agreement_id = 1 and l.listing_status_id = 1 and s.address_line is not null and s.address_line >'%' and s.zip is not null and l.source_alias_id is not NULL and l.property_id >0 and s.property_status = 'For sale|?New Construction') SELECT TOP 1 a.* FROM a Order by NEWID ();
NH_Basic,WITH a AS (SELECT TOP 10 s.mpr_id,l.source_alias_id, (l.address_line + ', '+l.city+', '+ l.state_code+', '+ l.zip) as Address FROM Property.dataagg.listings l(NOLOCK) INNER JOIN NewHome.nh.mapping_of_subdivision_plan_property b (NOLOCK) ON l.property_id = b.property_id Join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id and e.fulfillmentgroup_bitmask is NULL where l.state_code not in ('NULL','') AND l.city not like 'Binder%' AND L.agreement_id = 1 and l.listing_status_id = 1 and s.address_line is not null and s.address_line >'%' and s.zip is not null and l.source_alias_id is not NULL and l.property_id >0 and s.property_status = 'For sale|?New Construction') SELECT TOP 1 a.* FROM a Order by NEWID ()
*********************************************Abhishek Porch Wiget QUERIES 04242014************************************************
FS_COBROKEPORCH,SELECT top 1 s.mpr_id, d.source_alias_id,(d.address_line + ' ' +  d.city + ' ' + d.state_code + ' ' + d.zip) As Address FROM property.dataagg.listings d (NOLOCK) JOIN SE_Loading.dbo.property_repository s (nolock) on d.property_id = s.property_id and d.state_code = s.state_code JOIN property.mls.listings_extended_info c (NOLOCK) ON d.listing_id = c.listing_id JOIN Property.dbo.zips_sold_4_cobroke_connection AS cb (NOLOCK) ON d.zip = cb.zip WHERE 1=1 and d.nbr_bedroom is not NULL AND d.agreement_id = 1 and d.listing_status_id = 1 and d.property_id > 0 and display_flag = 1 and d.address_line != '' and d.street_name != '' and d.city != '' and d.state_code != '' and d.zip != '' and d.property_id IN (SELECT property_id FROM property.dataagg.listings WITH (NOLOCK) WHERE agreement_id = 1 AND listing_status_id = 1 AND city='Binder' AND s.property_status = 'For Sale' AND display_flag = 1 AND property_id > 0 GROUP BY property_id HAVING COUNT (*) = 1) AND c.fulfillmentgroup_bitmask is null
FS_SHOWCASEPORCH,SELECT top 1 s.mpr_id, d.source_alias_id,(d.address_line + ' ' +  d.city + ' ' + d.state_code + ' ' + d.zip) As Address FROM property.dataagg.listings d (NOLOCK) Join SE_Loading.dbo.property_repository s (nolock) on d.property_id = s.property_id and d.state_code = s.state_code JOIN property.mls.listings_extended_info c (NOLOCK) ON c.listing_id = d.listing_id WHERE 1=1 and d.nbr_bedroom is not NULL AND d.agreement_id = 1 and d.listing_status_id = 1 and d.property_id > 0 and display_flag = 1 and d.address_line != '' and d.street_name != '' and d.city != '' and d.state_code != '' and d.zip != '' and d.property_id IN (SELECT property_id FROM property.dataagg.listings WITH (NOLOCK) WHERE agreement_id = 1 AND listing_status_id = 1 AND city='Binder' AND s.property_status = 'For Sale' AND display_flag = 1 AND property_id > 0 GROUP BY property_id HAVING COUNT (*) = 1) and c.fulfillmentgroup_bitmask & 128 >1

FS_COBROKEPORCHPERMITHISTORY,SELECT TOP 1 ei.mpr_id, l.property_id, l.source_alias_id FROM Property.dataagg.listings AS l WITH ( NOLOCK ) JOIN Property.dbo.properties AS p WITH ( NOLOCK )ON l.property_id = p.property_id JOIN Property.mls.listings_extended_info li WITH ( NOLOCK ) ON li.listing_id = l.listing_id JOIN Property.dbo.zips_sold_4_cobroke_connection AS cb (NOLOCK) ON l.zip = cb.zip JOIN MasterPropertyRecord.dbo.property_external_ids ei WITH (NOLOCK) ON ei.property_id = p.state_code + cast(p.property_id AS varchar) LEFT OUTER JOIN property.dataagg.listing_attributes la WITH (NOLOCK) on l.listing_id = la.listing_id AND la.attribute_id = ( SELECT TOP 1 attribute_id FROM  [PropertyCommon].[dataagg].[master_listing_attributes] mla WITH (NOLOCK) WHERE mla.common_code = 'DA_PendingFlag' )WHERE   p.sa_property_id IS NOT NULL AND l.agreement_id = 1 AND l.datasource_id > 0 AND l.source_id <> 7 AND l.listing_status_id = 1 AND l.mls_display_flag = 1 AND li.fulfillmentgroup_bitmask is null AND l.property_type_id <> 6 AND la.listing_id IS NULL GROUP BY ei.mpr_id, l.source_alias_id, l.property_id HAVING COUNT (*) = 1
FS_SHOWCASEPORCHPERMITHISTORY,SELECT TOP 1 ei.mpr_id, l.property_id, l.source_alias_id FROM Property.dataagg.listings AS l WITH ( NOLOCK ) JOIN Property.dbo.properties AS p WITH ( NOLOCK )ON l.property_id = p.property_id JOIN Property.mls.listings_extended_info li WITH ( NOLOCK ) ON li.listing_id = l.listing_id JOIN MasterPropertyRecord.dbo.property_external_ids ei WITH (NOLOCK) ON ei.property_id = p.state_code + cast(p.property_id AS varchar)LEFT OUTER JOIN property.dataagg.listing_attributes la WITH (NOLOCK) on l.listing_id = la.listing_id AND la.attribute_id = ( SELECT TOP 1 attribute_id FROM  [PropertyCommon].[dataagg].[master_listing_attributes] mla WITH (NOLOCK)WHERE mla.common_code = 'DA_PendingFlag' ) WHERE   p.sa_property_id IS NOT NULL AND l.agreement_id = 1 AND l.datasource_id > 0 AND l.source_id <> 7 AND l.listing_status_id = 1 AND l.mls_display_flag = 1 AND li.fulfillmentgroup_bitmask & 128 > 0 AND l.property_type_id <> 6 AND la.listing_id IS NULL GROUP BY ei.mpr_id, l.source_alias_id, l.property_id HAVING COUNT (*) = 1
*********************************************Abhishek FS_showcase with atleast 1 photo QUERIES 04252014************************************************
FS_SHOWCASEPHOTO,WITH a AS ( SELECT top 1000 s.mpr_id from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask in ('2048') and l.agreement_id = 1 and l.listing_status_id = 1 and s.photo_count>0 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.source_alias_id like 'PROD%') SELECT top 1 a.* FROM a Order by NEWID ();

*********************************************Abhishek FS_showcase MLSID for MDOT QUERIES 05142014************************************************
FS_SHOWCASEMLS,WITH a AS ( SELECT top 1000 l.source_alias_id from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask in ('2048') and l.agreement_id = 1 and l.listing_status_id = 1 and s.photo_count>0 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.source_alias_id like 'PROD%') SELECT top 1 a.* FROM a Order by NEWID ();

******Lead Source Query just for reference******Method validateMCCLeadSource in Common.java uses the same query by fetching the DB details from Environment File and the Email ID at the time of submitting MCC Lead which is dynamic***************** 
LeadSRC,SELECT TOP 1 [LeadSource] ,[RequestDate] ,[ClientEmailAddress] FROM [DBMMCommon].[dbo].[LeadRequestsNotServed] (nolock) WHERE ClientEmailAddress like '%betagetestimate1@gmail.com%' and RequestDate > '11-22-2015' and RequestDate < '11-24-2015' order by RequestDate desc;


*********************************Validate Delivery ***************************
VALIDATE_DEL,EXEC dbo.spDA_ValidateDelivery @jobid=934199, @MLSID = '$$replace$$'

*********************************NonLead Address & MLSID search data for MDOT & Native App Projects - Added by Abhishek on 07142014 ****************************************************************************************************************
FS_BASIC_NonLead_Address,WITH a AS ( SELECT top 10 (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale'and l.city <> 'binder' and l.state_code not in ('NULL',''))SELECT top 1 a.* FROM a Order by NEWID ()
FR_BASIC_NonLead_Address,WITH a AS ( SELECT top 10 (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and l.listing_status_id = 6 and l.source_alias_id is not NULL and s.property_status = 'For Rent' and l.city <> 'binder' and l.state_code not in ('NULL',''))SELECT top 1 a.* FROM a Order by NEWID ()
RS_BASIC_NonLead_Address,WITH a AS ( SELECT top 10 (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and l.listing_status_id = 6 and l.source_alias_id is not NULL and s.property_status = 'Recently Sold' and l.city <> 'binder' and l.state_code not in ('NULL',''))SELECT top 1 a.* FROM a Order by NEWID ()
FS_Showcase_NonLead_Address,WITH a AS ( SELECT top 10 (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask in ('2048') and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.city <> 'binder' and l.state_code not in ('NULL','')) SELECT top 1 a.* FROM a Order by NEWID ();
FR_Showcase_NonLead_Address,WITH a AS ( SELECT top 10 (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask in ('64') and l.agreement_id = 1 and l.listing_status_id = 6 and l.source_alias_id is not NULL and s.property_status = 'For Rent' and l.city <> 'binder' and l.state_code not in ('NULL','')) SELECT top 1 a.* FROM a Order by NEWID ();
RS_Showcase_NonLead_Address,WITH a AS (SELECT top 100 (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask !='0' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'Recently Sold' and l.state_code not in ('NULL','') AND l.city not like 'Binder%') SELECT top 1 a.* FROM a Order by NEWID ()
FS_MlsId_NonLead,WITH a AS (SELECT top 1000 L.source_alias_id as MLS_ID from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask in ('3072') and l.agreement_id = 1 and s.se_deleted = 0 and s.selling_agent_advertiser_id = '919670' and s.selling_office_advertiser_id='1542036' and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') and l.city not like 'binder%') SELECT top 1 a.* FROM a where MLS_ID is not null Order by NEWID()

*********************************Lead Address & MLSID search data for MDOT & Native App Projects - Added by Abhishek on 07142014 *****************************************************************************************************************
FS_MlsId_Lead,WITH a AS (SELECT top 1000  L.source_alias_id from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') AND l.city like 'Binder%') SELECT top 1 a.* FROM a Order by NEWID ()
FS_BASIC_Lead_Address,WITH a AS ( SELECT top 10 (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale'and l.city like 'Binder%' and l.state_code not in ('NULL',''))SELECT top 1 a.* FROM a Order by NEWID ()
FR_BASIC_Lead_Address,WITH a AS ( SELECT top 10 (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and l.listing_status_id = 6 and l.source_alias_id is not NULL and s.property_status = 'For Rent' and l.city like 'Binder%' and l.state_code not in ('NULL',''))SELECT top 1 a.* FROM a Order by NEWID ()
FS_Showcase_Lead_Address,WITH a AS ( SELECT top 10 (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask in ('2048') and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.city like 'Binder%' and l.state_code not in ('NULL','')) SELECT top 1 a.* FROM a Order by NEWID ();
FR_Showcase_Lead_Address,WITH a AS ( SELECT top 10 (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask in ('64') and l.agreement_id = 1 and l.listing_status_id = 6 and l.source_alias_id is not NULL and s.property_status = 'For Rent' and l.city like 'Binder%' and l.state_code not in ('NULL','') and s.address_line not like '%#%') SELECT top 1 a.* FROM a Order by NEWID ();

*********************************Added by Abhishek on 07/24/2014 for mapping Zip & City State for validating Popular searches****************************************************************************************************************************************************************************************************************************************************************
FS_BASIC_ZipCS,WITH a AS ( SELECT top 10 s.zip, (s.city+', '+ s.state_code) as CityState from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale'and l.city='Denver' )SELECT top 1 a.* FROM a Order by NEWID ()
FR_BASIC_ZipCS,WITH a AS ( SELECT top 10 s.zip, (s.city+', '+ s.state_code) as CityState from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and l.listing_status_id = 6 and l.source_alias_id is not NULL and s.property_status = 'For Rent' and l.city='Austin')SELECT top 1 a.* FROM a Order by NEWID ()


FS_Showcase_C21,WITH a AS (select top 10 mpr.mpr_id,b.broker_name from MasterPropertyRecord.dbo.property_external_ids mpr (nolock) inner join Property.dataagg.listings l (nolock) on mpr.property_id = l.state_code + CONVERT(VARCHAR(10),l.property_id) inner join Property.mls.listings_extended_info lei (nolock) on l.listing_id = lei.listing_id and lei.fulfillmentgroup_bitmask IS NOT NULL inner join Property.dataagg.listing_agent_parties la (nolock) on l.listing_id = la.listing_id inner join Property.dataagg.offices o (nolock) on la.office_id = o.office_id inner join Property.mls.office_broker ob (nolock) on o.office_id = ob.office_id left join Property.mls.broker b (nolock) on ob.broker_id = b.broker_id left join Property.mls.office_gateway og (nolock) on o.office_id = og.office_id left join Property.mls.zGateway g (nolock) on og.gateway_id = g.gateway_id outer apply Property.dbo.fn_se_office_info(o.office_id) f where  1=1 and b.broker_id = 6902 and l.listing_status_id = 1) SELECT TOP 1 a.* FROM a Order by NEWID ()
FS_Showcase_NRT,WITH a AS (select top 10 mpr.mpr_id , b.broker_name from MasterPropertyRecord.dbo.property_external_ids mpr (nolock) inner join Property.dataagg.listings l (nolock) on mpr.property_id = l.state_code + CONVERT(VARCHAR(10),l.property_id) inner join Property.mls.listings_extended_info lei (nolock) on l.listing_id = lei.listing_id and lei.fulfillmentgroup_bitmask IS NOT NULL inner join Property.dataagg.listing_agent_parties la (nolock) on l.listing_id = la.listing_id inner join Property.dataagg.offices o (nolock) on la.office_id = o.office_id inner join Property.mls.office_broker ob (nolock) on o.office_id = ob.office_id left join Property.mls.broker b (nolock) on ob.broker_id = b.broker_id left join Property.mls.office_gateway og (nolock) on o.office_id = og.office_id left join Property.mls.zGateway g (nolock) on og.gateway_id = g.gateway_id outer apply Property.dbo.fn_se_office_info(o.office_id) f where  1=1 and b.broker_name like '%NRT Superbroker%' and l.listing_status_id = 1) SELECT TOP 1 a.* FROM a Order by NEWID ()
FS_Showcase_NonC21_NonNRT_nonbinder,WITH a AS (SELECT top 10 s.mpr_id FROM Property.dataagg.listings l(NOLOCK) Join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id Join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where 1=1 and e.fulfillmentgroup_bitmask & 128 >1 and agreement_id = 1 and l.listing_status_id = 1 and l.property_id >0 and s.udb_listing_id is not null and s.property_status = 'For Sale' AND s.mpr_id not in ( select top 1 mpr.mpr_id from MasterPropertyRecord.dbo.property_external_ids mpr (nolock) inner join Property.dataagg.listings l (nolock) on mpr.property_id = l.state_code + CONVERT(VARCHAR(10),l.property_id) inner join Property.mls.listings_extended_info lei (nolock) on l.listing_id = lei.listing_id and lei.fulfillmentgroup_bitmask IS NOT NULL inner join Property.dataagg.listing_agent_parties la (nolock) on l.listing_id = la.listing_id inner join Property.dataagg.offices o (nolock) on la.office_id = o.office_id inner join Property.mls.office_broker ob (nolock) on o.office_id = ob.office_id left join Property.mls.broker b (nolock) on ob.broker_id = b.broker_id left join Property.mls.office_gateway og (nolock) on o.office_id = og.office_id left join Property.mls.zGateway g (nolock) on og.gateway_id = g.gateway_id outer apply Property.dbo.fn_se_office_info(o.office_id) f where  1=1 and b.broker_id = 6902 and l.listing_status_id = 1 and b.broker_name = 'NRT Superbroker')) SELECT TOP 1 a.* FROM a Order by NEWID ()
FS_Showcase_NonC21_NonNRT,WITH a AS (SELECT top 10 s.mpr_id FROM Property.dataagg.listings l(NOLOCK) Join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id Join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code and l.city='Binder' and l.state_code='ca' where 1=1 and e.fulfillmentgroup_bitmask & 128 >1 and agreement_id = 1 and l.listing_status_id = 1 and l.property_id >0 and s.udb_listing_id is not null and s.property_status = 'For Sale' AND s.mpr_id not in ( select top 1 mpr.mpr_id from MasterPropertyRecord.dbo.property_external_ids mpr (nolock) inner join Property.dataagg.listings l (nolock) on mpr.property_id = l.state_code + CONVERT(VARCHAR(10),l.property_id) inner join Property.mls.listings_extended_info lei (nolock) on l.listing_id = lei.listing_id and lei.fulfillmentgroup_bitmask IS NOT NULL inner join Property.dataagg.listing_agent_parties la (nolock) on l.listing_id = la.listing_id inner join Property.dataagg.offices o (nolock) on la.office_id = o.office_id inner join Property.mls.office_broker ob (nolock) on o.office_id = ob.office_id left join Property.mls.broker b (nolock) on ob.broker_id = b.broker_id left join Property.mls.office_gateway og (nolock) on o.office_id = og.office_id left join Property.mls.zGateway g (nolock) on og.gateway_id = g.gateway_id outer apply Property.dbo.fn_se_office_info(o.office_id) f where  1=1 and b.broker_id = 6902 and l.listing_status_id = 1 and b.broker_name = 'NRT Superbroker')) SELECT TOP 1 a.* FROM a Order by NEWID ()

FS_Showcase_PorchNB,WITH a AS (SELECT top 10 s.mpr_id, d.source_alias_id,(d.address_line + ' ' +  d.city + ' ' + d.state_code + ' ' + d.zip) As Address FROM property.dataagg.listings d (NOLOCK) Join SE_Loading.dbo.property_repository s (nolock) on d.property_id = s.property_id and d.state_code = s.state_code JOIN property.mls.listings_extended_info c (NOLOCK) ON c.listing_id = d.listing_id WHERE 1=1 and d.nbr_bedroom is not NULL AND d.agreement_id = 1 and d.listing_status_id = 1 and d.property_id > 0 and display_flag = 1 and d.address_line != '' and d.street_name != '' and d.city != '' and d.state_code != '' and d.zip != '' and d.property_id IN (SELECT property_id FROM property.dataagg.listings WITH (NOLOCK) WHERE agreement_id = 1 AND listing_status_id = 1 AND city!='Binder' AND s.property_status = 'For Sale' AND display_flag = 1 AND property_id > 0 GROUP BY property_id HAVING COUNT (*) = 1) and c.fulfillmentgroup_bitmask & 128 >1 ) SELECT TOP 1 a.* FROM a Order by NEWID ()

*******************************Added by Faseena on 08/07/2014 for nonbinder Listing filtered by Zip or CityState***************************************************************************************************************************************************************************************************************************************************************************************
FS_BASICNB_wCityState,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and l.city='$$city$$' and l.state_code='$$state$$') SELECT top 1 a.* FROM a Order by NEWID ()
FS_BASICNB_wZip,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and l.zip='$$zip$$') SELECT top 1 a.* FROM a Order by NEWID ()
FR_BASICNB_wCityState,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask ='0' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'For Rent' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and l.city='$$city$$' and l.state_code='$$state$$') SELECT top 1 a.* FROM a Order by NEWID ()
FR_BASICNB_wZip,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask ='0' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'For Rent' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and l.zip='$$zip$$') SELECT top 1 a.* FROM a Order by NEWID ()
NFS_BASICNB_wCityState,WITH a AS (SELECT top 10 s.mpr_id, l.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and s.sold_date <'1/1/2010 12:00:00 AM' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'Off market' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and l.city='$$city$$' and l.state_code='$$state$$') SELECT top 1 a.* FROM a Order by NEWID ()
NFS_BASICNB_wZip,WITH a AS (SELECT top 10 s.mpr_id, l.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and s.sold_date <'1/1/2010 12:00:00 AM' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'Off market' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and l.zip='$$zip$$') SELECT top 1 a.* FROM a Order by NEWID ()
RS_BASICNB_wCityState,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask ='0' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'Recently Sold' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and l.city='$$city$$' and l.state_code='$$state$$') SELECT top 1 a.* FROM a Order by NEWID ()
RS_BASICNB_wZip,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask ='0' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'Recently Sold' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and l.zip='$$zip$$') SELECT top 1 a.* FROM a Order by NEWID ()
FS_FORECLOSURESNB_wCityState,WITH a AS (Select top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from property.dataagg.listings l (nolock) join property.dataagg.listing_attributes a (nolock) on l.listing_id = a.listing_id join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where a.attribute_id = 3 and a.attribute_value ='Foreclosed' and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and l.city='$$city$$' and l.state_code='$$state$$') SELECT top 1 a.* FROM a Order by NEWID ()
FS_FORECLOSURESNB_wZip,WITH a AS (Select top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from property.dataagg.listings l (nolock) join property.dataagg.listing_attributes a (nolock) on l.listing_id = a.listing_id join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where a.attribute_id = 3 and a.attribute_value ='Foreclosed' and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and l.zip='$$zip$$') SELECT top 1 a.* FROM a Order by NEWID ()
FR_SHOWCASENB_wCityState,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask !='0' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'For Rent' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and l.city='$$city$$' and l.state_code='$$state$$') SELECT top 1 a.* FROM a Order by NEWID ()
FR_SHOWCASENB_wZip,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask !='0' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'For Rent' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and l.zip='$$zip$$') SELECT top 1 a.* FROM a Order by NEWID ()
RS_SHOWCASENB_wCityState,WITH a AS (SELECT top 100 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask !='0' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'Recently Sold' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and l.city='$$city$$' and l.state_code='$$state$$') SELECT top 1 a.* FROM a Order by NEWID ()
RS_SHOWCASENB_wZip,WITH a AS (SELECT top 100 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask !='0' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'Recently Sold' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and l.zip='$$zip$$') SELECT top 1 a.* FROM a Order by NEWID ()
FS_OFFICEAGENTSHOWNB_wCityState,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask in ('3072') and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') and l.city not like 'binder%' and l.city='$$city$$' and l.state_code='$$state$$') SELECT top 1 a.* FROM a where Address is not null Order by NEWID ()
FS_OFFICEAGENTSHOWNB_wZip,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask in ('3072') and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') and l.city not like 'binder%' and l.zip='$$zip$$') SELECT top 1 a.* FROM a where Address is not null Order by NEWID ()
FS_AGENTSHOWNB_wCityState,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask in ('128') and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') and l.city not like 'binder%' and l.city='$$city$$' and l.state_code='$$state$$') SELECT top 1 a.* FROM a Order by NEWID ()
FS_AGENTSHOWNB_wZip,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask in ('128') and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') and l.city not like 'binder%' and l.zip='$$zip$$') SELECT top 1 a.* FROM a Order by NEWID ()
FS_OFFICESHOWNB_wCityState,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask in ('3072') and l.agreement_id = 1 and s.se_deleted = 0 and s.selling_agent_advertiser_id = '919670' and s.selling_office_advertiser_id='1542036' and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') and l.city not like 'binder%' and l.city='$$city$$' and l.state_code='$$state$$') SELECT top 10 a.* FROM a where Address is not null Order by NEWID()
FS_OFFICESHOWNB_wZip,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask in ('3072') and l.agreement_id = 1 and s.se_deleted = 0 and s.selling_agent_advertiser_id = '919670' and s.selling_office_advertiser_id='1542036' and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') and l.city not like 'binder%' and l.zip='$$zip$$') SELECT top 10 a.* FROM a where Address is not null Order by NEWID()
FS_COBROKENB_wCityState,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address FROM Property.dataagg.listings l (nolock) JOIN SE_Loading.dbo.property_repository (NOLOCK) s on l.property_id = s.property_id and l.state_code = s.state_code JOIN Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id JOIN Property.dbo.zips_sold_4_cobroke_connection z4cb ON s.state_code = z4cb.state_code AND s.zip = z4cb.zip and z4cb.zip in ('93012','99504','70118') where l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') and l.city not like 'binder%' and s.has_cobroke = 1 and l.city='$$city$$' and l.state_code='$$state$$') SELECT TOP 1 a.* FROM a Order by NEWID ()
FS_COBROKENB_wZip,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address FROM Property.dataagg.listings l (nolock) JOIN SE_Loading.dbo.property_repository (NOLOCK) s on l.property_id = s.property_id and l.state_code = s.state_code JOIN Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id JOIN Property.dbo.zips_sold_4_cobroke_connection z4cb ON s.state_code = z4cb.state_code AND s.zip = z4cb.zip and z4cb.zip in ('93012','99504','70118') where l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') and l.city not like 'binder%' and s.has_cobroke = 1 and l.zip='$$zip$$') SELECT TOP 1 a.* FROM a Order by NEWID ()
FS_C21NB_wCityState,WITH a AS (SELECT TOP 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address FROM Property.dataagg.listings l(NOLOCK) INNER JOIN property.dataagg.offices o (NOLOCK) ON l.datasource_id = o.datasource_id Join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id Join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where e.fulfillmentgroup_bitmask is not NULL and l.city not IN ('Binder', 'Binder Six', 'Binder%') and agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.property_id >0 and s.property_status = 'For Sale' AND EXISTS (SELECT TOP 1 1 FROM Property.dataagg.listing_agent_parties la (NOLOCK) WHERE la.listing_id = l.listing_id AND o.office_id = la.office_id) AND o.office_name LIKE '%21%' and l.city='$$city$$' and l.state_code='$$state$$') SELECT TOP 1 a.* FROM a Order by NEWID ()
FS_C21NB_wZip,WITH a AS (SELECT TOP 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address FROM Property.dataagg.listings l(NOLOCK) INNER JOIN property.dataagg.offices o (NOLOCK) ON l.datasource_id = o.datasource_id Join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id Join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where e.fulfillmentgroup_bitmask is not NULL and l.city not IN ('Binder', 'Binder Six', 'Binder%') and agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.property_id >0 and s.property_status = 'For Sale' AND EXISTS (SELECT TOP 1 1 FROM Property.dataagg.listing_agent_parties la (NOLOCK) WHERE la.listing_id = l.listing_id AND o.office_id = la.office_id) AND o.office_name LIKE '%21%' and l.zip='$$zip$$') SELECT TOP 1 a.* FROM a Order by NEWID ()
NH_SHOWCASENB_wCityState,WITH a AS (SELECT TOP 1000 s.mpr_id,l.source_alias_id, (l.address_line + ', '+l.city+', '+ l.state_code+', '+ l.zip) as Address FROM Property.dataagg.listings l(NOLOCK) INNER JOIN NewHome.nh.mapping_of_subdivision_plan_property b (NOLOCK) ON l.property_id = b.property_id Join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id and e.fulfillmentgroup_bitmask is not NULL where l.state_code not in ('NULL','') AND l.city not like 'Binder%' AND L.agreement_id = 1 and l.listing_status_id = 1 and s.address_line is not null and s.address_line >'%' and s.zip is not null and l.source_alias_id is not NULL and l.property_id >0 and s.property_status = 'For sale|?New Construction'and l.city='$$city$$' and l.state_code='$$state$$') SELECT TOP 1 a.* FROM a Order by NEWID ()
NH_SHOWCASENB_wZip,WITH a AS (SELECT TOP 1000 s.mpr_id,l.source_alias_id, (l.address_line + ', '+l.city+', '+ l.state_code+', '+ l.zip) as Address FROM Property.dataagg.listings l(NOLOCK) INNER JOIN NewHome.nh.mapping_of_subdivision_plan_property b (NOLOCK) ON l.property_id = b.property_id Join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id and e.fulfillmentgroup_bitmask is not NULL where l.state_code not in ('NULL','') AND l.city not like 'Binder%' AND L.agreement_id = 1 and l.listing_status_id = 1 and s.address_line is not null and s.address_line >'%' and s.zip is not null and l.source_alias_id is not NULL and l.property_id >0 and s.property_status = 'For sale|?New Construction' and l.zip='$$zip$$') SELECT TOP 1 a.* FROM a Order by NEWID ()

*******************************Added by Faseena on 08/08/2014 for Listing filtered by Zip or CityState***************************************************************************************************************************************************************************************************************************************************************************************
FS_BASIC_wCityState,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') and l.city='$$city$$' and l.state_code='$$state$$') SELECT top 1 a.* FROM a Order by NEWID ()
FS_BASIC_wZip,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') and l.zip='$$zip$$') SELECT top 1 a.* FROM a Order by NEWID ()
FR_BASIC_wCityState,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask ='0' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'For Rent' and l.state_code not in ('NULL','') and l.city='$$city$$' and l.state_code='$$state$$') SELECT top 1 a.* FROM a Order by NEWID ()
FR_BASIC_wZip,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask ='0' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'For Rent' and l.state_code not in ('NULL','') and l.zip='$$zip$$') SELECT top 1 a.* FROM a Order by NEWID ()
NFS_BASIC_wCityState,WITH a AS (SELECT TOP 50 s.mpr_id,(L.address_line + ', '+L.city+', '+ L.state_code+', '+ L.zip) as Address from SE_Loading.dbo.property_repository s (nolock) join Property.dataagg.listings l  (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.property_status = 'Off market' and l.listing_status_id = 7 and l.agreement_id = 1 and l.city='$$city$$' and l.state_code='$$state$$') SELECT TOP 1 a.* FROM a Order by NEWID ()
NFS_BASIC_wZip,WITH a AS (SELECT TOP 50 s.mpr_id,(L.address_line + ', '+L.city+', '+ L.state_code+', '+ L.zip) as Address from SE_Loading.dbo.property_repository s (nolock) join Property.dataagg.listings l  (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.property_status = 'Off market' and l.listing_status_id = 7 and l.agreement_id = 1 and l.zip='$$zip$$') SELECT TOP 1 a.* FROM a Order by NEWID ()
RS_BASIC_wCityState,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'Recently Sold' and l.state_code not in ('NULL','') and l.city='$$city$$' and l.state_code='$$state$$') SELECT top 1 a.* FROM a Order by NEWID ()
RS_BASIC_wZip,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'Recently Sold' and l.state_code not in ('NULL','') and l.zip='$$zip$$') SELECT top 1 a.* FROM a Order by NEWID ()
FS_FORECLOSURES_wCityState,WITH a AS (Select top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from property.dataagg.listings l (nolock) join property.dataagg.listing_attributes a (nolock) on l.listing_id = a.listing_id join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where a.attribute_id = 3 and a.attribute_value ='Foreclosed' and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and l.city='$$city$$' and l.state_code='$$state$$') SELECT top 1 a.* FROM a Order by NEWID ()
FS_FORECLOSURES_wZip,WITH a AS (Select top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from property.dataagg.listings l (nolock) join property.dataagg.listing_attributes a (nolock) on l.listing_id = a.listing_id join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where a.attribute_id = 3 and a.attribute_value ='Foreclosed' and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and l.zip='$$zip$$') SELECT top 1 a.* FROM a Order by NEWID ()
FR_SHOWCASE_wCityState,WITH a AS ( SELECT top 100 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address, A.EMAIL from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id Join Property.dataagg.listing_agent_parties la (nolock) on l.listing_id = la.listing_id join Property.dataagg.agents a on a.agent_id=la.agent_id where e.fulfillmentgroup_bitmask = '2048' and a.email is not NULL and l.agreement_id = 1 and l.listing_status_id = 6 and l.source_alias_id is not NULL and s.property_status = 'For Rent'and l.state_code not in ('NULL','') and l.city='$$city$$' and l.state_code='$$state$$')SELECT top 1 a.* FROM a Order by NEWID ();
FR_SHOWCASE_wCityState_Old,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask !='0' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'For Rent' and l.state_code not in ('NULL','') and l.city='$$city$$' and l.state_code='$$state$$') SELECT top 1 a.* FROM a Order by NEWID ()
FR_SHOWCASE_wZip,WITH a AS ( SELECT top 100 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address, A.EMAIL from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id Join Property.dataagg.listing_agent_parties la (nolock) on l.listing_id = la.listing_id join Property.dataagg.agents a on a.agent_id=la.agent_id where e.fulfillmentgroup_bitmask = '2048' and a.email is not NULL and l.agreement_id = 1 and l.listing_status_id = 6 and l.source_alias_id is not NULL and s.property_status = 'For Rent'and l.state_code not in ('NULL','') and l.zip='$$zip$$')SELECT top 1 a.* FROM a Order by NEWID ();
FR_SHOWCASE_wZip_Old,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask !='0' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'For Rent' and l.state_code not in ('NULL','') and l.zip='$$zip$$') SELECT top 1 a.* FROM a Order by NEWID ()
RS_SHOWCASE_wCityState,WITH a AS (SELECT top 100 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask !='0' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'Recently Sold' and l.state_code not in ('NULL','') and l.city='$$city$$' and l.state_code='$$state$$') SELECT top 1 a.* FROM a Order by NEWID ()
RS_SHOWCASE_wZip,WITH a AS (SELECT top 100 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask !='0' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'Recently Sold' and l.state_code not in ('NULL','') and l.zip='$$zip$$') SELECT top 1 a.* FROM a Order by NEWID ()
FS_OFFICEAGENTSHOW_wCityState,WITH a AS (SELECT top 10 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address, A.EMAIL from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id Join Property.dataagg.listing_agent_parties la (nolock) on l.listing_id = la.listing_id join Property.dataagg.agents a on a.agent_id=la.agent_id where e.fulfillmentgroup_bitmask in ('3072') and a.email is not NULL and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') and l.city='$$city$$' and l.state_code='$$state$$') SELECT top 1 a.* FROM a where Address is not null Order by NEWID ()
FS_OFFICEAGENTSHOW_wCityState_Old,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask in ('3072') and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') and l.city='$$city$$' and l.state_code='$$state$$') SELECT top 1 a.* FROM a where Address is not null Order by NEWID ()
FS_OFFICEAGENTSHOW_wZip,WITH a AS (SELECT top 10 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address, A.EMAIL from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id Join Property.dataagg.listing_agent_parties la (nolock) on l.listing_id = la.listing_id join Property.dataagg.agents a on a.agent_id=la.agent_id where e.fulfillmentgroup_bitmask in ('3072') and a.email is not NULL and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') and l.zip='$$zip$$') SELECT top 1 a.* FROM a where Address is not null Order by NEWID ()
FS_OFFICEAGENTSHOW_wZip_Old,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask in ('3072') and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') and l.zip='$$zip$$') SELECT top 1 a.* FROM a where Address is not null Order by NEWID ()
FS_AGENTSHOW_wCityState,WITH a AS (SELECT top 10 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address , A.EMAIL from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id Join Property.dataagg.listing_agent_parties la (nolock) on l.listing_id = la.listing_id join Property.dataagg.agents a on a.agent_id=la.agent_id where e.fulfillmentgroup_bitmask in ('128') and a.email is not NULL and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') and l.city='$$city$$' and l.state_code='$$state$$') SELECT top 1 a.* FROM a Order by NEWID ()
FS_AGENTSHOW_wCityState_Old,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask in ('128') and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') and l.city='$$city$$' and l.state_code='$$state$$') SELECT top 1 a.* FROM a Order by NEWID ()
FS_AGENTSHOW_wZip,WITH a AS (SELECT top 10 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address , A.EMAIL from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id Join Property.dataagg.listing_agent_parties la (nolock) on l.listing_id = la.listing_id join Property.dataagg.agents a on a.agent_id=la.agent_id where e.fulfillmentgroup_bitmask in ('128') and a.email is not NULL and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') and l.zip='$$zip$$') SELECT top 1 a.* FROM a Order by NEWID ()
FS_AGENTSHOW_wZip_Old,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask in ('128') and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') and l.zip='$$zip$$') SELECT top 1 a.* FROM a Order by NEWID ()
FS_OFFICESHOW_wCityState,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask in ('3072') and l.agreement_id = 1 and s.se_deleted = 0 and s.selling_agent_advertiser_id = '919670' and s.selling_office_advertiser_id='1542036' and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') and l.city='$$city$$' and l.state_code='$$state$$') SELECT top 10 a.* FROM a where Address is not null Order by NEWID()
FS_OFFICESHOW_wZip,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask in ('3072') and l.agreement_id = 1 and s.se_deleted = 0 and s.selling_agent_advertiser_id = '919670' and s.selling_office_advertiser_id='1542036' and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') and l.zip='$$zip$$') SELECT top 10 a.* FROM a where Address is not null Order by NEWID()
FS_COBROKE_wCityState,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address FROM Property.dataagg.listings l (nolock) JOIN SE_Loading.dbo.property_repository (NOLOCK) s on l.property_id = s.property_id and l.state_code = s.state_code JOIN Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id JOIN Property.dbo.zips_sold_4_cobroke_connection z4cb ON s.state_code = z4cb.state_code AND s.zip = z4cb.zip and z4cb.zip in ('00020') where l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') and s.has_cobroke = 1 and l.city='$$city$$' and l.state_code='$$state$$') SELECT TOP 1 a.* FROM a Order by NEWID ()
FS_OfficeStd_wCityState,WITH a AS ( SELECT top 1000 s.mpr_id,l.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask = '64' and s.property_status = 'For Sale' and l.city='$$city$$' and l.state_code='$$state$$') SELECT TOP 1 a.* FROM a Order by NEWID ();
FS_OfficeStd_wZip,WITH a AS ( SELECT top 1000 s.mpr_id,l.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask = '64' and s.property_status = 'For Sale' and l.zip='$$zip$$') SELECT TOP 1 a.* FROM a Order by NEWID ();
FS_COBROKE_wCityState_OLD,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address FROM Property.dataagg.listings l (nolock) JOIN SE_Loading.dbo.property_repository (NOLOCK) s on l.property_id = s.property_id and l.state_code = s.state_code JOIN Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id JOIN Property.dbo.zips_sold_4_cobroke_connection z4cb ON s.state_code = z4cb.state_code AND s.zip = z4cb.zip where l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') and s.has_cobroke = 1 and l.city='$$city$$' and l.state_code='$$state$$') SELECT TOP 1 a.* FROM a Order by NEWID ()
FS_COBROKE_wZip,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address FROM Property.dataagg.listings l (nolock) JOIN SE_Loading.dbo.property_repository (NOLOCK) s on l.property_id = s.property_id and l.state_code = s.state_code JOIN Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id JOIN Property.dbo.zips_sold_4_cobroke_connection z4cb ON s.state_code = z4cb.state_code AND s.zip = z4cb.zip where l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') and s.has_cobroke = 1 and l.zip='$$zip$$') SELECT TOP 1 a.* FROM a Order by NEWID ()
FS_C21_wCityState,WITH a AS (SELECT TOP 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address FROM Property.dataagg.listings l(NOLOCK) INNER JOIN property.dataagg.offices o (NOLOCK) ON l.datasource_id = o.datasource_id Join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id Join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where e.fulfillmentgroup_bitmask is not NULL and l.city not IN ('Binder', 'Binder Six', 'Binder%') and agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.property_id >0 and s.property_status = 'For Sale' AND EXISTS (SELECT TOP 1 1 FROM Property.dataagg.listing_agent_parties la (NOLOCK) WHERE la.listing_id = l.listing_id AND o.office_id = la.office_id) AND o.office_name LIKE '%21%' and l.city='$$city$$' and l.state_code='$$state$$') SELECT TOP 1 a.* FROM a Order by NEWID ()
FS_C21_wZip,WITH a AS (SELECT TOP 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address FROM Property.dataagg.listings l(NOLOCK) INNER JOIN property.dataagg.offices o (NOLOCK) ON l.datasource_id = o.datasource_id Join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id Join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where e.fulfillmentgroup_bitmask is not NULL and l.city not IN ('Binder', 'Binder Six', 'Binder%') and agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.property_id >0 and s.property_status = 'For Sale' AND EXISTS (SELECT TOP 1 1 FROM Property.dataagg.listing_agent_parties la (NOLOCK) WHERE la.listing_id = l.listing_id AND o.office_id = la.office_id) AND o.office_name LIKE '%21%' and l.zip='$$zip$$') SELECT TOP 1 a.* FROM a Order by NEWID ()
NH_Basic_wCityState,WITH a AS (SELECT TOP 1000 s.mpr_id,l.source_alias_id, (l.address_line + ', '+l.city+', '+ l.state_code+', '+ l.zip) as Address FROM Property.dataagg.listings l(NOLOCK) INNER JOIN NewHome.nh.mapping_of_subdivision_plan_property b (NOLOCK) ON l.property_id = b.property_id Join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id and e.fulfillmentgroup_bitmask is NULL where l.state_code not in ('NULL','') AND l.city not like 'Binder%' AND L.agreement_id = 1 and l.listing_status_id = 1 and s.address_line is not null and s.address_line >'%' and s.zip is not null and l.source_alias_id is not NULL and l.property_id >0 and s.property_status = 'For sale|?New Construction' and l.city='$$city$$' and l.state_code='$$state$$') SELECT TOP 1 a.* FROM a Order by NEWID ()
NH_Basic_wZip,WITH a AS (SELECT TOP 1000 s.mpr_id,l.source_alias_id, (l.address_line + ', '+l.city+', '+ l.state_code+', '+ l.zip) as Address FROM Property.dataagg.listings l(NOLOCK) INNER JOIN NewHome.nh.mapping_of_subdivision_plan_property b (NOLOCK) ON l.property_id = b.property_id Join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id and e.fulfillmentgroup_bitmask is NULL where l.state_code not in ('NULL','') AND l.city not like 'Binder%' AND L.agreement_id = 1 and l.listing_status_id = 1 and s.address_line is not null and s.address_line >'%' and s.zip is not null and l.source_alias_id is not NULL and l.property_id >0 and s.property_status = 'For sale|?New Construction' and l.zip='$$zip$$') SELECT TOP 1 a.* FROM a Order by NEWID ()
NH_SHOWCASE_wCityState,WITH a AS ( SELECT TOP 1000 s.mpr_id,l.source_alias_id, (l.address_line + ', '+l.city+', '+ l.state_code+', '+ l.zip) as Address FROM Property.dataagg.listings l(NOLOCK) INNER JOIN NewHome.nh.mapping_of_subdivision_plan_property b (NOLOCK) ON l.property_id = b.property_id Join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id and e.fulfillmentgroup_bitmask is not NULL where L.agreement_id = 1 and l.listing_status_id = 1 and s.address_line is not null and s.address_line >'%' and s.zip is not null and l.source_alias_id is not NULL and l.property_id >0 and s.property_status = 'For sale|?New Construction' and l.city='$$city$$' and l.state_code='$$state$$') SELECT TOP 1 a.* FROM a Order by NEWID ();
NH_SHOWCASE_wZip,WITH a AS ( SELECT TOP 1000 s.mpr_id,l.source_alias_id, (l.address_line + ', '+l.city+', '+ l.state_code+', '+ l.zip) as Address FROM Property.dataagg.listings l(NOLOCK) INNER JOIN NewHome.nh.mapping_of_subdivision_plan_property b (NOLOCK) ON l.property_id = b.property_id Join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id and e.fulfillmentgroup_bitmask is not NULL where L.agreement_id = 1 and l.listing_status_id = 1 and s.address_line is not null and s.address_line >'%' and s.zip is not null and l.source_alias_id is not NULL and l.property_id >0 and s.property_status = 'For sale|?New Construction' and l.zip='$$zip$$') SELECT TOP 1 a.* FROM a Order by NEWID ();

************************************************************************************************************************
FS_fullAdd,WITH a AS (SELECT top 1000  (s.address_line + ', '+s.city+', '+ s.state_code +' '+s.zip) as Address,l.county from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and s.address_line not like '%#%' and s.address_line not like '%-%'and s.address_line not like '%unit%') SELECT top 1 a.* FROM a Order by NEWID ()
NFS_fullAdd,WITH a AS (SELECT top 10 (s.address_line + ', '+s.city+', '+ s.state_code +' '+s.zip) as Address,l.county from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and s.sold_date <'1/1/2010 12:00:00 AM' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'Off market' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and s.address_line not like '%#%' and s.address_line not like '%-%'and s.address_line not like '%unit%') SELECT top 1 a.* FROM a Order by NEWID ()
RS_fullAdd,WITH a AS (SELECT top 1000  (s.address_line + ', '+s.city+', '+ s.state_code +' '+s.zip) as Address,l.county from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask ='0' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'Recently Sold' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and s.address_line not like '%#%' and s.address_line not like '%-%'and s.address_line not like '%unit%') SELECT top 1 a.* FROM a Order by NEWID ()
FR_fullAdd,WITH a AS (SELECT top 1000 (s.address_line + ', '+s.city+', '+ s.state_code +' '+s.zip) as Address,l.county from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask ='0' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'For Rent' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and s.address_line not like '%#%' and s.address_line not like '%-%'and s.address_line not like '%unit%') SELECT top 1 a.* FROM a Order by NEWID ()
StateName,SELECT state_name from Property.dbo.states where state_abbreviation ='$$StateCode$$'

FR_UnitRentals,With a AS (SELECT top 10 s.mpr_id, (l.address_line + ' ' +  l.city + ' ' + l.state_code + ' ' + l.zip) as Address, l.listing_status_id, l.city, l.state_code, l.source_alias_id  FROM Property.dataagg.listings AS l (NOLOCK) JOIN Property.dbo.zips_sold_4_cobroke_connection AS cb (NOLOCK) ON l.zip = cb.zip join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id  and l.state_code = s.state_code WHERE l.agreement_id = 1 AND datasource_id >0 AND cb.change_type_id <> 2 AND l.property_id > 0 and l.nbr_bedroom is not null and l.city <> '' and l.state_code <> '' and s.property_status = 'For rent')  SELECT top 1 a.* FROM a Order by NEWID ()
FR_MLSRentals,With a AS (SELECT distinct top 10 s.mpr_id, (l.address_line + ' ' +  l.city + ' ' + l.state_code + ' ' + l.zip) as Address, l.listing_status_id, l.city FROM Property.dataagg.listings AS l (NOLOCK)JOIN Property.dbo.zips_sold_4_cobroke_connection AS cb (NOLOCK)ON l.zip = cb.zip join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id  and l.state_code = s.state_code WHERE l.agreement_id = 1 AND datasource_id = -50 AND cb.change_type_id <> 2 AND l.property_id > 0 and s.property_status = 'For rent') SELECT top 1 a.* FROM a Order by NEWID ()    

FS_SignRider,SELECT TOP 1 ls.mpr_id FROM SE_Loading.dbo.property_repository pr (NOLOCK)  JOIN property.dbo.listings_summary ls (NOLOCK) ON pr.mpr_id = ls.mpr_id JOIN property.dataagg.master_listings pml (NOLOCK) ON ls.master_listing_id = pml.master_listing_id JOIN [Property].[dataagg].[listings] l (NOLOCK) ON pml.listing_id = l.listing_id JOIN [Property].[dataagg].[listing_agent_parties] lp (NOLOCK) ON l.listing_id = lp.listing_id AND lp.type_id=1 JOIN property.dataagg.agents a (NOLOCK) ON lp.agent_id = a.agent_id JOIN [xAdvertiser].[dbo].[ADVERTISER_ATTRIBUTE] aa(NOLOCK) ON a.advertiser_id = aa.AdvertiserID JOIN property.mls.listings_extended_info lei (NOLOCK) ON lei.listing_id = l.listing_id WHERE se_deleted = 0 AND ls.animated_sign_rider IS NOT NULL AND ls.animated_sign_rider <> '|?' AND lei.fulfillmentgroup_bitmask & 1024 > 0 AND aa.attributeid=50 AND ls.listing_status_id = 1 AND pr.property_status = 'for sale'AND pr.city_search NOT LIKE '%binder%'Order by NEWID ()
FS_MlsId_SignRider,SELECT top 1 l.source_alias_id as "MLS ID" FROM SE_Loading.dbo.property_repository pr (NOLOCK)  JOIN property.dbo.listings_summary ls (NOLOCK) ON pr.mpr_id = ls.mpr_id JOIN property.dataagg.master_listings pml (NOLOCK) ON ls.master_listing_id = pml.master_listing_id JOIN [Property].[dataagg].[listings] l (NOLOCK) ON pml.listing_id = l.listing_id JOIN [Property].[dataagg].[listing_agent_parties] lp (NOLOCK) ON l.listing_id = lp.listing_id AND lp.type_id=1 JOIN property.dataagg.agents a (NOLOCK) ON lp.agent_id = a.agent_id JOIN [xAdvertiser].[dbo].[ADVERTISER_ATTRIBUTE] aa(NOLOCK) ON a.advertiser_id = aa.AdvertiserID JOIN property.mls.listings_extended_info lei (NOLOCK) ON lei.listing_id = l.listing_id WHERE se_deleted = 0 AND ls.animated_sign_rider IS NOT NULL AND ls.animated_sign_rider <> '|?' AND lei.fulfillmentgroup_bitmask & 1024 > 0 AND aa.attributeid=50 AND ls.listing_status_id = 1 AND pr.property_status = 'for sale' AND pr.city_search NOT LIKE '%binder%' Order by NEWID ()

FS_MlsId_VideoLink,SELECT top 10 lm.Description from xProperty.dbo.LISTING_MEDIA lm (nolock) where lm.MediaTypeID = 18 and lm.Description like 'C31%'
FS_BASIC_Pending,WITH a AS ( SELECT top 100 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and s.property_status_raw like '%For Sale|?Pending%' and s.mpr_id!='8097129866') SELECT top 1 a.* FROM a Order by NEWID ()
FS_BASIC_noBadge_OLD,WITH a AS ( SELECT top 10 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and s.property_status_raw not like '%For Sale|?Pending Offer%' and s.property_status_raw not like '%For Sale|?Active-Exclusive Right%')SELECT top 1 a.* FROM a Order by NEWID ()
FS_BASIC_noBadge,WITH a AS ( SELECT top 10 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and (s.property_status_raw not like '%For Sale|?New%' and s.property_status_raw not like '%For Sale|?Pending%')) SELECT top 1 a.* FROM a Order by NEWID ()
NH_BDX,With a As (select top 100 nhp.id, nhp.name from NewHome.nh.plans nhp (nolock) where nhp.is_deleted = 0) SELECT TOP 1 a.* FROM a Order by NEWID ();
NH_Plan,With a As (select top 100 nhp.id, nhp.name from NewHome.nh.plans nhp (nolock) where nhp.is_deleted = 0) SELECT TOP 1 a.* FROM a Order by NEWID ();
NH_Communities,With a As (select top 100 nhq.id, nhq.name, nhq.city, nhq.state_code from NewHome.nh.subdivisions nhq (nolock) where status = 'Active' and nhq.is_deleted = 0) SELECT TOP 1 a.* FROM a Order by NEWID ();
PhotoCount1,Select top 1 l.listing_id,l.address_line, l.city, l.state_code, l.zip ,COUNT( * ) as 'Total Photo' from Property.dataagg.listing_media m (nolock) join Property.dataagg.listings l (nolock) on l.listing_id = m.listing_id and l.agreement_id = 1 join SE_Loading.dbo.property_repository se (nolock)on se.property_id = l.property_id and se.state_code=l.state_code where se.mpr_id = '$$MPRID$$' and se.se_deleted = 0 and l.raw_status = 'active' group by l.listing_id, l.address_line, l.city, l.state_code, l.zip

FSMprId_StyleLink,With a As (select top 100 mpr_id from SE_Loading.dbo.property_repository (nolock) where property_status = 'For Sale' and style ='$$StyleLink$$') SELECT TOP 1 a.* FROM a Order by NEWID ();
ForeclosureMprId_StyleLink,WITH a AS (Select top 10 s.mpr_id as Address from property.dataagg.listings l (nolock) join property.dataagg.listing_attributes a (nolock) on l.listing_id = a.listing_id join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where a.attribute_id = 3 and a.attribute_value ='Foreclosed' and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.style = '$$StyleLink$$') SELECT top 1 a.* FROM a Order by NEWID ()
FRShowcaseMprId_StyleLink,WITH a AS ( SELECT top 100 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask = '2048' and l.agreement_id = 1 and l.listing_status_id = 6 and l.source_alias_id is not NULL and s.property_status = 'For Rent' and s.style is not NULL and s.style like'%$$StyleLink$$%')SELECT top 1 a.* FROM a Order by NEWID ();
FSAgentCardDetails,WITH a AS (select top 10 mpr.mpr_id,la.agent_id,a.agent_name,a.office_phone,a.mobile_phone from MasterPropertyRecord.dbo.property_external_ids mpr (nolock) inner join Property.dataagg.listings l (nolock) on mpr.property_id = l.state_code + CONVERT(VARCHAR(10),l.property_id) inner join Property.mls.listings_extended_info lei (nolock) on l.listing_id = lei.listing_id and lei.fulfillmentgroup_bitmask IS NOT NULL inner join Property.dataagg.listing_agent_parties la (nolock) on l.listing_id = la.listing_id join Property.dataagg.agents a on a.agent_id=la.agent_id where mpr.mpr_id = '$$MprId$$' and l.listing_status_id = 1 ) SELECT TOP 1 a.* FROM a Order by NEWID ()
FSBrokerCardDetails,WITH a AS (select top 10 mpr.mpr_id,o.office_id,o.office_name,o.phone from MasterPropertyRecord.dbo.property_external_ids mpr (nolock) inner join Property.dataagg.listings l (nolock) on mpr.property_id = l.state_code + CONVERT(VARCHAR(10),l.property_id) inner join Property.mls.listings_extended_info lei (nolock) on l.listing_id = lei.listing_id and lei.fulfillmentgroup_bitmask IS NOT NULL inner join Property.dataagg.listing_agent_parties la (nolock) on l.listing_id = la.listing_id inner join Property.dataagg.offices o (nolock) on la.office_id = o.office_id inner join Property.mls.office_broker ob (nolock) on o.office_id = ob.office_id left join Property.mls.broker b (nolock) on ob.broker_id = b.broker_id left join Property.mls.office_gateway og (nolock) on o.office_id = og.office_id left join Property.mls.zGateway g (nolock) on og.gateway_id = g.gateway_id outer apply Property.dbo.fn_se_office_info(o.office_id) f where mpr.mpr_id='$$MprId$$'and l.listing_status_id = 1) SELECT TOP 1 a.* FROM a Order by NEWID ()
FSAgentCardDetailslocSrcId,WITH a AS (select top 10 mpr.mpr_id,o.office_id,o.office_name,o.phone,o.state,o.city,l.source_alias_id,l.datasource_id from MasterPropertyRecord.dbo.property_external_ids mpr (nolock) inner join Property.dataagg.listings l (nolock) on mpr.property_id = l.state_code + CONVERT(VARCHAR(10),l.property_id) inner join Property.mls.listings_extended_info lei (nolock) on l.listing_id = lei.listing_id and lei.fulfillmentgroup_bitmask IS NOT NULL inner join Property.dataagg.listing_agent_parties la (nolock) on l.listing_id = la.listing_id inner join Property.dataagg.offices o (nolock) on la.office_id = o.office_id inner join Property.mls.office_broker ob (nolock) on o.office_id = ob.office_id left join Property.mls.broker b (nolock) on ob.broker_id = b.broker_id left join Property.mls.office_gateway og (nolock) on o.office_id = og.office_id left join Property.mls.zGateway g (nolock) on og.gateway_id = g.gateway_id outer apply Property.dbo.fn_se_office_info(o.office_id) f where mpr.mpr_id='$$MprId$$'and l.listing_status_id = 1) SELECT TOP 1 a.* FROM a Order by NEWID ()

FS_FC_future,WITH a AS ( Select top 10 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from property.dataagg.listings l (nolock) join property.dataagg.listing_attributes a (nolock) on l.listing_id = a.listing_id join SE_Loading.dbo.property_repository s  (nolock) on l.property_id = s.property_id and l.state_code = s.state_code   where a.attribute_id = 3 and a.attribute_value ='Foreclosed' and l.agreement_id = 1   and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL   and s.listing_date>GETDATE()) SELECT top 1 a.* FROM a Order by NEWID ()
FS_FC_lessthan90min,WITH a AS ( Select top 10 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from property.dataagg.listings l (nolock) join property.dataagg.listing_attributes a (nolock) on l.listing_id = a.listing_id join SE_Loading.dbo.property_repository s  (nolock) on l.property_id = s.property_id and l.state_code = s.state_code   where a.attribute_id = 3 and a.attribute_value ='Foreclosed' and l.agreement_id = 1   and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL   and s.listing_date<GETDATE()and DATEDIFF(MINUTE,s.listing_date,GETDATE())<90) SELECT top 1 a.* FROM a Order by NEWID ()
FS_FC_morethan90min,WITH a AS ( Select top 10 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from property.dataagg.listings l (nolock) join property.dataagg.listing_attributes a (nolock) on l.listing_id = a.listing_id join SE_Loading.dbo.property_repository s  (nolock) on l.property_id = s.property_id and l.state_code = s.state_code   where a.attribute_id = 3 and a.attribute_value ='Foreclosed' and l.agreement_id = 1   and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL   and s.listing_date<GETDATE()and DATEDIFF(MINUTE,s.listing_date,GETDATE())>90 and DATEDIFF(DAY,s.listing_date,GETDATE())=0) SELECT top 1 a.* FROM a Order by NEWID ()
FS_FC_1day,WITH a AS ( Select top 10 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from property.dataagg.listings l (nolock) join property.dataagg.listing_attributes a (nolock) on l.listing_id = a.listing_id join SE_Loading.dbo.property_repository s  (nolock) on l.property_id = s.property_id and l.state_code = s.state_code   where a.attribute_id = 3 and a.attribute_value ='Foreclosed' and l.agreement_id = 1   and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL   and s.listing_date<GETDATE() and DATEDIFF(DAY,s.listing_date,GETDATE())=1) SELECT top 1 a.* FROM a Order by NEWID ()
FS_FC_xdays,WITH a AS ( Select top 10 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from property.dataagg.listings l (nolock) join property.dataagg.listing_attributes a (nolock) on l.listing_id = a.listing_id join SE_Loading.dbo.property_repository s  (nolock) on l.property_id = s.property_id and l.state_code = s.state_code   where a.attribute_id = 3 and a.attribute_value ='Foreclosed' and l.agreement_id = 1   and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL   and s.listing_date<GETDATE() and DATEDIFF(DAY,s.listing_date,GETDATE())>1) SELECT top 1 a.* FROM a Order by NEWID ()
FS_NHC_future,With a As (select top 100 nhq.id, nhq.name, nhq.city, nhq.state_code from NewHome.nh.subdivisions nhq (nolock) where status = 'Active' and nhq.is_deleted = 0 and nhq.system_creation_time>GETDATE()) SELECT TOP 1 a.* FROM a Order by NEWID ();
FS_NHC_lessthan90min,With a As (select top 100 nhq.id, nhq.name, nhq.city, nhq.state_code from NewHome.nh.subdivisions nhq (nolock) where status = 'Active' and nhq.is_deleted = 0 and nhq.system_creation_time<GETDATE() and DATEDIFF(MINUTE,nhq.system_creation_time,GETDATE())<90) SELECT TOP 1 a.* FROM a Order by NEWID ();
FS_NHC_morethan90min,With a As (select top 100 nhq.id, nhq.name, nhq.city, nhq.state_code from NewHome.nh.subdivisions nhq (nolock) where status = 'Active' and nhq.is_deleted = 0 and nhq.system_creation_time<GETDATE() and DATEDIFF(MINUTE,nhq.system_creation_time,GETDATE())>90 and DATEDIFF(DAY,nhq.system_creation_time,GETDATE())=0 ) SELECT TOP 1 a.* FROM a Order by NEWID ();
FS_NHC_1day,With a As (select top 100 nhq.id, nhq.name, nhq.city, nhq.state_code from NewHome.nh.subdivisions nhq (nolock) where status = 'Active' and nhq.is_deleted = 0 and nhq.system_creation_time<GETDATE() and DATEDIFF(DAY,nhq.system_creation_time,GETDATE())=1 ) SELECT TOP 1 a.* FROM a Order by NEWID ();
FS_NHC_xdays,With a As (select top 100 nhq.id, nhq.name, nhq.city, nhq.state_code from NewHome.nh.subdivisions nhq (nolock) where status = 'Active' and nhq.is_deleted = 0 and nhq.system_creation_time<GETDATE() and DATEDIFF(DAY,nhq.system_creation_time,GETDATE())>1 ) SELECT TOP 1 a.* FROM a Order by NEWID ();
FS_NHP_future,With a As (select top 100 nhp.id, nhp.name from NewHome.nh.plans nhp (nolock) where nhp.is_deleted = 0 and nhp.system_creation_time>GETDATE()) SELECT TOP 1 a.* FROM a Order by NEWID ();
FS_NHP_lessthan90min,With a As (select top 100 nhp.id, nhp.name from NewHome.nh.plans nhp (nolock) where nhp.is_deleted = 0 and nhp.system_creation_time<GETDATE() and DATEDIFF(MINUTE,nhp.system_creation_time,GETDATE())<90) SELECT TOP 1 a.* FROM a Order by NEWID ();
FS_NHP_morethan90min,With a As (select top 100 nhp.id, nhp.name from NewHome.nh.plans nhp (nolock) where nhp.is_deleted = 0 and nhp.system_creation_time<GETDATE() and DATEDIFF(MINUTE,nhp.system_creation_time,GETDATE())>90 and DATEDIFF(DAY,nhp.system_creation_time,GETDATE())=0 ) SELECT TOP 1 a.* FROM a Order by NEWID ();
FS_NHP_1day,With a As (select top 100 nhp.id, nhp.name from NewHome.nh.plans nhp (nolock) where nhp.is_deleted = 0 and nhp.system_creation_time<GETDATE() and DATEDIFF(DAY,nhp.system_creation_time,GETDATE())=1 ) SELECT TOP 1 a.* FROM a Order by NEWID ();
FS_NHP_xdays,With a As (select top 100 nhp.id, nhp.name from NewHome.nh.plans nhp (nolock) where nhp.is_deleted = 0 and nhp.system_creation_time<GETDATE() and DATEDIFF(DAY,nhp.system_creation_time,GETDATE())>1 ) SELECT TOP 1 a.* FROM a Order by NEWID ();
FS_Showcase_future,WITH a AS ( SELECT top 1000 s.mpr_id from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask in ('2048') and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.raw_status='Active' and l.source_alias_id is not NULL and s.listing_date>GETDATE()) SELECT top 1 a.* FROM a Order by NEWID ();
FS_Showcase_lessthan90min,WITH a AS ( SELECT top 1000 s.mpr_id from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask in ('2048') and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.raw_status='Active' and l.source_alias_id is not NULL and s.listing_date<GETDATE() and DATEDIFF(MINUTE,s.listing_date,GETDATE())<90) SELECT top 1 a.* FROM a Order by NEWID ();
FS_Showcase_morethan90min,WITH a AS ( SELECT top 1000 s.mpr_id from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask in ('2048') and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.raw_status='Active' and l.source_alias_id is not NULL and s.listing_date<GETDATE() and DATEDIFF(MINUTE,s.listing_date,GETDATE())>90 and DATEDIFF(DAY,s.listing_date,GETDATE())=0 ) SELECT top 1 a.* FROM a Order by NEWID ();
FS_Showcase_1day,WITH a AS ( SELECT top 1000 s.mpr_id from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask in ('2048') and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.raw_status='Active' and l.source_alias_id is not NULL and s.listing_date<GETDATE() and DATEDIFF(DAY,s.listing_date,GETDATE())=1 ) SELECT top 1 a.* FROM a Order by NEWID ();
FS_Showcase_xdays,WITH a AS ( SELECT top 1000 s.mpr_id from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask in ('2048') and l.agreement_id = 1 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.raw_status='Active' and l.source_alias_id is not NULL and s.listing_date<GETDATE() and DATEDIFF(DAY,s.listing_date,GETDATE())>1 ) SELECT top 1 a.* FROM a Order by NEWID ();
FS_Co_Show,WITH a AS (SELECT top 1000 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask in ('3072') and l.agreement_id = 1 and s.se_deleted = 0 and s.selling_agent_advertiser_id = '93627' and s.selling_office_advertiser_id='26269' and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') and l.city not like 'binder%') SELECT top 10 a.* FROM a Order by NEWID ()
PropertyID,Select  property_id, state_code from  [SE_Loading].[dbo].[property_repository]  where mpr_id='$$MPRID$$'
SalesHistory,select  *  from  [Property].[dbo].GetSHData4Property('$$PropertyID$$','$$StateCode$$')
TaxHistory,select  *  from  [Property].[dbo].GetTHData4Property('$$PropertyID$$','$$StateCode$$')


***************************************************************** F O R     L E A D    T E S T I N G !!!!   Added by TEENA on 06/09/2015 *********************************************************************

***FOR SALE BASIC LISTINGS
FS_BINDER_BASIC,WITH a AS ( SELECT top 10 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL AND S.city IS NOT NULL AND S.state_code != '' and l.agreement_id = 1 and l.listing_status_id = 1 and s.se_deleted = 0 and s.property_type = 'land' and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.source_alias_id IS NOT NULL AND S.address_line IS NOT NULL)SELECT top 1 a.* FROM a Order by NEWID ();


***FOR SALE CO-BROKE LISTINGS
FS_BINDER_COBROKE,WITH a AS (SELECT top 10 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address FROM Property.dataagg.listings l (nolock) JOIN SE_Loading.dbo.property_repository (NOLOCK) s on l.property_id = s.property_id and l.state_code = s.state_code JOIN Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id join Property.dataagg.listing_agent_parties la (nolock) on l.listing_id = la.listing_id join Property.dataagg.agents a (NOLOCK) on a.agent_id=la.agent_id JOIN Property.dataagg.offices do (nolock) on a.office_id = do.office_id where l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and e.fulfillmentgroup_bitmask is NULL and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') AND S.address_line IS NOT NULL and l.city like 'binder%' and s.has_cobroke = 1 and a.office_id IS NOT NULL AND A.agent_id IS NOT NULL AND a.office_phone IS NOT NULL AND a.mobile_phone IS NOT NULL and do.phone IS NOT NULL) SELECT TOP 1 a.* FROM a Order by NEWID ();


***FOR SALE OFFICE AND AGENT SHOWCASE LISTINGS
FS_BINDER_OFFICEAGENTSHOWCASE,WITH a AS (SELECT top 10 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address, FROM Property.dataagg.listings l (nolock) JOIN SE_Loading.dbo.property_repository (NOLOCK) s on l.property_id = s.property_id and l.state_code = s.state_code JOIN Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id join Property.dataagg.listing_agent_parties la (nolock) on l.listing_id = la.listing_id join Property.dataagg.agents a (NOLOCK) on a.agent_id=la.agent_id JOIN Property.dataagg.offices do (nolock) on a.office_id = do.office_id where l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and e.fulfillmentgroup_bitmask IS NOT NULL AND DO.udb_office_id IS NOT NULL AND DO.advertiser_id IS NOT NULL AND DO.office_id IS NOT NULL and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') AND S.address_line IS NOT NULL and l.city like 'binder%' AND A.agent_name IS NOT NULL AND A.email IS NOT NULL AND DO.phone IS NOT NULL) SELECT TOP 1 a.* FROM a Order by NEWID ();

***NEW HOME COMMUNITIES Added By Sonu On 12/4/2015
NH_COMMUNITIESB,With a As (select top 100 nhq.id, nhq.name, nhq.city, nhq.state_code from NewHome.nh.subdivisions nhq (nolock) where status = 'Active' and nhq.is_deleted = 0 and nhq.city like 'binder%') SELECT TOP 1 a.* FROM a Order by NEWID ();

***FOR RENT BINDER BASIC Added By Sonu On 12/7/2015
FR_BINDER_BASIC,WITH a AS ( SELECT top 10 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and l.listing_status_id = 6 and l.source_alias_id is not NULL and s.property_status = 'For Rent' and l.source_alias_id like 'PROD%' )SELECT top 1 a.* FROM a Order by NEWID ()

***FOR New homes/plans Added by Sonu on 03/07/2016
NH_PLAN_BINDER,With a As (select top 100 nhp.id, nhp.name from NewHome.nh.plans nhp left join NewHome.nh.specs nhs (nolock) on nhp.plan_id=nhs.plan_id where nhs.city like '%binder%'and nhp.name not like 'Brittany' and nhp.is_deleted = 0) SELECT TOP 1 a.* FROM a Order by NEWID ();

*****************************************************Binder Queries for NFS and recently Sold************Added by shashi on 10/12/2015*******************************
NFS_BINDER_BASIC,WITH a AS (SELECT top 100 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock)on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock)on e.listing_id = l.listing_id and s.sold_date < dateadd( dd, -730,convert(varchar,getdate(),112)) and l.agreement_id = 1and l.source_alias_id is not NULL and s.property_status = 'Off market'and s.se_deleted = 1and l.state_code not in ('NULL','') AND l.city like 'binder%') SELECT top 1 a.* FROM a Order by NEWID ()
RS_BINDER_BASIC,WITH a AS (SELECT top 100 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip)as Address from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask !='0'and l.agreement_id = 1 and s.se_deleted = 0and l.source_alias_id is not NULL and s.property_status = 'Recently Sold' and l.state_code not in ('NULL','')AND l.city like 'Binder%') SELECT top 1 a.* FROM a Order by NEWID ()
FR_BINDER_Showcase,WITH a AS ( SELECT top 10 s.mpr_id, e.fulfillmentgroup_bitmask, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask > 0 and l.agreement_id = 1 and l.listing_status_id = 6 and l.source_alias_id is not NULL and s.property_status = 'For Rent' and l.source_alias_id like 'PROD%' and s.mpr_id <> '2339009341' and s.mpr_id <> '2189051188') SELECT top 10 a.* FROM a Order by NEWID ()

*******Query for Seller Lead Added By Sonu****************
RS_Three_Agents_Zip_old,WITH a AS (SELECT top 20 afa.AttributeValue, COUNT (DISTINCT af.AdvertiserID) as 'TOTAL NUMBER OF AGENTS'FROM xAdvertiser.dbo.ADVERTISER_FULFILLMENT_ATTRIBUTE afa (NOLOCK)JOIN xAdvertiser.dbo.ADVERTISER_FULFILLMENT af (NOLOCK)ON af.AdvertiserFulfillmentID = afa.AdvertiserFulfillmentID AND 3 = afa.AttributeID WHERE AF.FulfillmentGroupID = 31 and afa.AttributeValue in (93536)Group by AFA.AttributeValue HAVING COUNT (AFA.AttributeValue) > 2 Order by 'TOTAL NUMBER OF AGENTS' desc) SELECT top 1 a.* FROM a Order by NEWID ()
RS_Two_Agents_Zip_old,WITH a AS (SELECT top 20 afa.AttributeValue, COUNT (DISTINCT af.AdvertiserID) as 'TOTAL NUMBER OF AGENTS' FROM xAdvertiser.dbo.ADVERTISER_FULFILLMENT_ATTRIBUTE afa (NOLOCK) JOIN xAdvertiser.dbo.ADVERTISER_FULFILLMENT af (NOLOCK) ON af.AdvertiserFulfillmentID = afa.AdvertiserFulfillmentID AND 3 = afa.AttributeID WHERE AF.FulfillmentGroupID = 31 and afa.AttributeValue in (89509) Group by AFA.AttributeValue HAVING COUNT (AFA.AttributeValue) = 2 Order by 'TOTAL NUMBER OF AGENTS' desc) SELECT top 1 a.* FROM a Order by NEWID ()
RS_One_Agents_Zip_old,WITH a AS (SELECT top 20 afa.AttributeValue, COUNT (DISTINCT af.AdvertiserID) as 'TOTAL NUMBER OF AGENTS' FROM xAdvertiser.dbo.ADVERTISER_FULFILLMENT_ATTRIBUTE afa (NOLOCK) JOIN xAdvertiser.dbo.ADVERTISER_FULFILLMENT af (NOLOCK) ON af.AdvertiserFulfillmentID = afa.AdvertiserFulfillmentID AND 3 = afa.AttributeID WHERE AF.FulfillmentGroupID = 31 and afa.AttributeValue in (95682,94021,90002,89403,89011) Group by AFA.AttributeValue HAVING COUNT (AFA.AttributeValue) = 1 Order by 'TOTAL NUMBER OF AGENTS' desc) SELECT top 1 a.* FROM a Order by NEWID ()
RS_Zero_Agents_Zip_old,WITH a AS (SELECT top 1000 afa.AttributeValue FROM xAdvertiser.dbo.ADVERTISER_FULFILLMENT_ATTRIBUTE afa (NOLOCK) JOIN xAdvertiser.dbo.ADVERTISER_FULFILLMENT af (NOLOCK) ON af.AdvertiserFulfillmentID = afa.AdvertiserFulfillmentID AND 3 = afa.AttributeID WHERE AF.FulfillmentGroupID not in (31) and af.BillingReferenceID != ' ' and afa.AttributeValue in (00001,00002,00003,00004,00005,00006,00007,00008,00009,00010,00011,00012,00013,00014,00015,00016,00019,00020,91362,91377,98021,99999) )SELECT top 1 a.* FROM a Order by NEWID ()

RS_Three_Agents_Zip,WITH a AS (SELECT top 20 afa.AttributeValue, COUNT (DISTINCT af.AdvertiserID) as 'TOTAL NUMBER OF AGENTS' FROM xAdvertiser.dbo.ADVERTISER_FULFILLMENT_ATTRIBUTE afa(NOLOCK) JOIN xAdvertiser.dbo.ADVERTISER_FULFILLMENT af (NOLOCK) ON af.AdvertiserFulfillmentID = afa.AdvertiserFulfillmentID AND 3 = afa.AttributeID WHERE AF.FulfillmentGroupID = 31 and afa.AttributeValue not in (60949,61822) Group by AFA.AttributeValue HAVING COUNT (AFA.AttributeValue) > 2 Order by 'TOTAL NUMBER OF AGENTS' desc) SELECT top 1 a.* FROM a Order by NEWID ()
RS_Two_Agents_Zip,WITH a AS (SELECT top 20 afa.AttributeValue, COUNT (DISTINCT af.AdvertiserID) as 'TOTAL NUMBER OF AGENTS' FROM xAdvertiser.dbo.ADVERTISER_FULFILLMENT_ATTRIBUTE afa (NOLOCK) JOIN xAdvertiser.dbo.ADVERTISER_FULFILLMENT af (NOLOCK)ON af.AdvertiserFulfillmentID = afa.AdvertiserFulfillmentID AND 3 = afa.AttributeID WHERE AF.FulfillmentGroupID = 31 and afa.AttributeValue not in (44011,30002) Group by AFA.AttributeValue HAVING COUNT (AFA.AttributeValue) = 2 Order by 'TOTAL NUMBER OF AGENTS' desc) SELECT top 1 a.* FROM a Order by NEWID ()
RS_One_Agents_Zip,WITH a AS (SELECT top 20 afa.AttributeValue, COUNT (DISTINCT af.AdvertiserID) as 'TOTAL NUMBER OF AGENTS' FROM xAdvertiser.dbo.ADVERTISER_FULFILLMENT_ATTRIBUTE afa (NOLOCK) JOIN xAdvertiser.dbo.ADVERTISER_FULFILLMENT af (NOLOCK) ON af.AdvertiserFulfillmentID = afa.AdvertiserFulfillmentID AND 3 = afa.AttributeID WHERE AF.FulfillmentGroupID = 31 and afa.AttributeValue not in (44011,30002) Group by AFA.AttributeValue HAVING COUNT (AFA.AttributeValue) = 1 Order by 'TOTAL NUMBER OF AGENTS' desc) SELECT top 1 a.* FROM a Order by NEWID ()
RS_Zero_Agents_Zip,WITH a AS (SELECT top 1000 afa.AttributeValue FROM xAdvertiser.dbo.ADVERTISER_FULFILLMENT_ATTRIBUTE afa (NOLOCK) JOIN xAdvertiser.dbo.ADVERTISER_FULFILLMENT af (NOLOCK) ON af.AdvertiserFulfillmentID = afa.AdvertiserFulfillmentID AND 3 = afa.AttributeID WHERE AF.FulfillmentGroupID not in (31)) SELECT top 1 a.* FROM a Order by NEWID ()

RS_SellerLead_MprId,WITH a AS (SELECT top 50 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l(nolock)join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where s.zip = $$ZipCode$$ and s.se_deleted = 0 and s.property_status = 'Recently Sold' ) SELECT top 1 a.* FROM a Order by NEWID ()
RS_BINDER_SellerLead_MprId,WITH a AS (SELECT top 50 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l(nolock)join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where s.zip = $$ZipCode$$ and s.se_deleted = 0 and s.city like 'Binder%' and s.property_status = 'Recently Sold' ) SELECT top 1 a.* FROM a Order by NEWID ()
NFS_SellerLead_MprId,WITH a AS (SELECT top 50 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l(nolock)join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where s.zip = $$ZipCode$$ and s.se_deleted = 0 and s.property_status = 'Off market' ) SELECT top 1 a.* FROM a Order by NEWID ()
NFS_BINDER_SellerLead_MprId,WITH a AS (SELECT top 50 s.mpr_id, L.source_alias_id, (s.address_line + ', '+s.city+', '+ s.state_code+', '+ s.zip) as Address from Property.dataagg.listings l(nolock)join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where s.zip = $$ZipCode$$ and s.se_deleted = 0 and s.city like 'Binder%' and s.property_status = 'Off market' ) SELECT top 1 a.* FROM a Order by NEWID ()

RS_Zero_Agents_Zip_old,SELECT top 1 AttributeValue FROM xAdvertiser.dbo.ADVERTISER_FULFILLMENT_ATTRIBUTE where AttributeValue like '93535'
*******************************************************Query for Open House*************************Added by Sibani on 03/01/2016******************
FS_OPENHOUSE_ZIP,WITH a AS (SELECT top 10 l.zip as "ZipCode Search" FROM  Property.dataagg.listings l (NOLOCK) JOIN  Property.mls.listings_extended_info e (NOLOCK) ON  l.listing_id = e.listing_id JOIN  Property.mls.listing_event ev (NOLOCK) ON  l.listing_id = ev.listing_id join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id  and l.state_code = s.state_code WHERE 1=1 AND  l.listing_status_id = 1 and ev.start_date >= CURRENT_TIMESTAMP and ev.contact_phone is not null and s.dq_id is not null and s.se_deleted = 0 order by ev.start_date desc) SELECT top 1 a.* FROM a Order by NEWID ()
FS_OPENHOUSE_All,SELECT top 5 ev.start_date, ev.end_date,  l.zip, l.address_line, l.city, l.*, ev.* FROM  Property.dataagg.listings l (NOLOCK) JOIN  Property.mls.listings_extended_info e (NOLOCK) ON  l.listing_id = e.listing_id JOIN  Property.mls.listing_event ev (NOLOCK) ON  l.listing_id = ev.listing_id join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id  and l.state_code = s.state_code WHERE 1=1 AND  l.listing_status_id = 1 and ev.start_date >= CURRENT_TIMESTAMP and ev.contact_phone is not null and s.dq_id is not null and s.se_deleted = 0 order by ev.start_date desc
FS_OPENHOUSE_CITYSTATE,WITH a AS (SELECT top 10 l.city+ ','+ l.state_code as "City State Search" FROM  Property.dataagg.listings l (NOLOCK) JOIN  Property.mls.listings_extended_info e (NOLOCK) ON  l.listing_id = e.listing_id JOIN  Property.mls.listing_event ev (NOLOCK) ON  l.listing_id = ev.listing_id join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id  and l.state_code = s.state_code WHERE 1=1 AND  l.listing_status_id = 1 and ev.start_date >= CURRENT_TIMESTAMP and ev.contact_phone is not null and s.dq_id is not null and s.se_deleted = 0 and l.city not like '%(City)%' order by ev.start_date desc) SELECT top 1 a.* FROM a Order by NEWID ()

*******************************************************Query for 'For Sale' City, State, Zip, County, Neighbourhood, Street Searches*************************Added by Sibani on 03/29/2016******************
FS_CITY_STATE,WITH a AS (SELECT top 10  s.city+', '+ s.state_code as "City State Search" from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and s.address_line not like '%#%' and s.address_line not like '%-%'and s.address_line not like '%unit%' and s.city not like 'NULL' and s.state_code not like 'NULL' and s.address_line like '[1-9]%' ) SELECT top 1 a.* FROM a Order by NEWID ()
FS_ZIP,WITH a AS (SELECT top 10  s.zip as "ZipCode Search" from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and s.address_line not like '%#%' and s.address_line not like '%-%'and s.address_line not like '%unit%' and s.zip not like 'NULL' and s.address_line like '[1-9]%' ) SELECT top 1 a.* FROM a Order by NEWID ()
FS_COUNTY,WITH a AS (SELECT top 10  s.county+' County,'+ s.state_code as "County Search" from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and s.address_line not like '%#%' and s.address_line not like '%-%'and s.address_line not like '%unit%' and s.county not like 'NULL' and s.address_line like '[1-9]%' ) SELECT top 1 a.* FROM a Order by NEWID ()
FS_NEIGHBOURHOOD,WITH a AS (SELECT top 10  SUBSTRING(s.neighborhood,0,CHARINDEX('|', s.neighborhood,0)) as "Neighbourhood Search" from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and s.address_line not like '%#%' and s.address_line not like '%-%'and s.address_line not like '%unit%' and s.neighborhood not like 'NULL' and s.address_line like '[1-9]%' ) SELECT top 1 a.* FROM a Order by NEWID ()
FS_STREET,WITH a AS (SELECT top 10  s.street_number+' , '+s.street_name+' , '+s.city+' , '+ s.state_code as "Street Search" from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Sale' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and s.address_line not like '%#%' and s.address_line not like '%-%'and s.address_line not like '%unit%' and s.street_number not like 'NULL' and s.address_line like '[1-9]%' ) SELECT top 1 a.* FROM a Order by NEWID ()

*******************************************************Query for 'For Rent' City, State, Zip, County, Neighbourhood Searches*************************Added by Sibani on 03/29/2016******************
FR_CITY_STATE,WITH a AS (SELECT top 10 s.city+', '+ s.state_code as "City State Search" from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask ='0' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.city not like 'NULL' and s.state_code not like 'NULL' and s.property_status = 'For Rent' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and s.address_line not like '%#%' and s.address_line not like '%-%'and s.address_line not like '%unit%') SELECT top 1 a.* FROM a Order by NEWID ()
FR_ZIP,WITH a AS (SELECT distinct top 50 s.zip as "ZipCode Search" from Property.dataagg.listings l (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask is not null and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.zip not like 'NULL' and s.property_status = 'For Rent' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and s.address_line not like '%#%' and s.address_line not like '%-%'and s.address_line not like '%unit%') SELECT top 1 a.* FROM a Order by NEWID ()
FR_COUNTY,WITH a AS (SELECT top 10 s.county+' County,'+ s.state_code as "County Search" from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask ='0' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.county not like 'NULL' and s.property_status = 'For Rent' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and s.address_line not like '%#%' and s.address_line not like '%-%'and s.address_line not like '%unit%') SELECT top 1 a.* FROM a Order by NEWID ()
FR_NEIGHBOURHOOD,WITH a AS (SELECT top 5  SUBSTRING(s.neighborhood,0,CHARINDEX('|', s.neighborhood,0)) as "Neighbourhood Search" from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Rent' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and s.address_line not like '%#%' and s.address_line not like '%-%'and s.address_line not like '%unit%' and s.neighborhood not like 'NULL' and s.address_line like '[1-9]%' ) SELECT top 1 a.* FROM a Order by NEWID ()
FR_STREET,WITH a AS (SELECT top 10  s.street_number+' , '+s.street_name+' , '+s.city+' , '+ s.state_code as "Street Search" from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'For Rent' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and s.address_line not like '%#%' and s.address_line not like '%-%'and s.address_line not like '%unit%' and s.street_number not like 'NULL' and s.address_line like '[1-9]%' ) SELECT top 1 a.* FROM a Order by NEWID ()
*******************************************************Query for 'Recently Sold' City, State, Zip, County, Neighbourhood Searches*************************Added by Sibani on 03/29/2016******************
RS_CITY_STATE,WITH a AS (SELECT top 10 s.city+', '+ s.state_code as "City State Search" from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask ='0' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'Recently Sold' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and s.address_line not like '%#%' and s.address_line not like '%-%'and s.address_line not like '%unit%') SELECT top 1 a.* FROM a Order by NEWID ()
RS_ZIP,WITH a AS (SELECT top 10 s.zip as "ZipCode Search" from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask ='0' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'Recently Sold' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and s.address_line not like '%#%' and s.zip not like 'NULL' and s.address_line not like '%-%'and s.address_line not like '%unit%') SELECT top 1 a.* FROM a Order by NEWID ()
RS_NEIGHBOURHOOD,WITH a AS (SELECT top 5  SUBSTRING(s.neighborhood,0,CHARINDEX('|', s.neighborhood,0)) as "Neighbourhood Search" from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'Recently Sold' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and s.address_line not like '%#%' and s.address_line not like '%-%'and s.address_line not like '%unit%' and s.neighborhood not like 'NULL' and s.address_line like '[1-9]%' ) SELECT top 1 a.* FROM a Order by NEWID ()
RS_COUNTY,WITH a AS (SELECT top 10 s.county+' County,'+ s.state_code as "County Search" from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code where s.fulfillmentgroup_bitmask ='0' and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'Recently Sold' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and s.address_line not like '%#%' and s.county not like 'NULL' and s.address_line not like '%-%'and s.address_line not like '%unit%') SELECT top 1 a.* FROM a Order by NEWID ()
RS_STREET,WITH a AS (SELECT top 10  s.street_number+' , '+s.street_name+' , '+s.city+' , '+ s.state_code as "Street Search" from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'Recently Sold' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and s.address_line not like '%#%' and s.address_line not like '%-%'and s.address_line not like '%unit%' and s.street_number not like 'NULL' and s.address_line like '[1-9]%' ) SELECT top 1 a.* FROM a Order by NEWID ()
*******************************************************Query for 'ALL HOMES' City, State, Zip, County, Neighbourhood Searches*************************Added by Sibani on 03/29/2016******************
NFS_CITY_STATE,WITH a AS (SELECT top 10 s.city+', '+ s.state_code as "City State Search" from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'Off market' and s.city not like 'NULL' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and s.address_line not like '%#%' and s.address_line not like '%-%'and s.address_line not like '%unit%') SELECT top 1 a.* FROM a Order by NEWID ()
NFS_ZIP,WITH a AS (SELECT top 10 s.zip as "ZipCode Search" from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'Off market' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and s.address_line not like '%#%' and s.zip not like 'NULL' and s.address_line not like '%-%'and s.address_line not like '%unit%') SELECT top 1 a.* FROM a Order by NEWID ()
NFS_COUNTY,WITH a AS (SELECT top 10 s.county+' County,'+ s.state_code as "County Search" from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and s.se_deleted = 0 and l.source_alias_id is not NULL and s.property_status = 'Off market' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and s.address_line not like '%#%' and s.county not like 'NULL' and s.address_line not like '%-%'and s.address_line not like '%unit%') SELECT top 1 a.* FROM a Order by NEWID ()
NFS_NEIGHBOURHOOD,WITH a AS (SELECT top 5  SUBSTRING(s.neighborhood,0,CHARINDEX('|', s.neighborhood,0)) as "Neighbourhood Search" from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'Off market' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and s.address_line not like '%#%' and s.address_line not like '%-%'and s.address_line not like '%unit%' and s.neighborhood not like 'NULL' and s.address_line like '[1-9]%' ) SELECT top 1 a.* FROM a Order by NEWID ()
NFS_STREET,WITH a AS (SELECT top 10  s.street_number+' , '+s.street_name+' , '+s.city+' , '+ s.state_code as "Street Search" from Property.dataagg.listings l  (nolock) join SE_Loading.dbo.property_repository s (nolock) on l.property_id = s.property_id and l.state_code = s.state_code join Property.mls.listings_extended_info e (nolock) on e.listing_id = l.listing_id where e.fulfillmentgroup_bitmask is NULL and l.agreement_id = 1 and s.se_deleted = 0 and l.listing_status_id = 1 and l.source_alias_id is not NULL and s.property_status = 'Off market' and l.state_code not in ('NULL','') AND l.city not like 'Binder%' and s.address_line not like '%#%' and s.address_line not like '%-%'and s.address_line not like '%unit%' and s.street_number not like 'NULL' and s.address_line like '[1-9]%' ) SELECT top 1 a.* FROM a Order by NEWID ()