*******************************************(BELOW ACCOUNT QUERY ADDED BY VIJENDRA-03-28-16)*******************************************
TCV_VALIDATION,with ASSET_VAL as (select sum(total_net) TCV,accountid from dm.asset_d where isdeleted=0 and status='Active' and current_flag='Y' AND ASSET_TYPE ='PARENT' GROUP BY accountid)select a12.ID, a12.PARTY_ID, a12.TOTAL_CONTRACT_VALUE, a13.TCV from DM.ACCOUNT_D a12 join ASSET_VAL a13 on a13.accountid = a12.ID and (a12.TOTAL_CONTRACT_VALUE - a13.TCV)>0.5and a12.isdeleted=0 and a12.status='Active' and a12.current_flag='Y';
TOTAL_CLC_VALIDATION,SELECT PARTY_ID__C,TOTAL_CLC__C FROM REPO_ODS_SRV.REPO_ODS.SFDC.ACCOUNT WHERE STATUS__C = 'Active' and ISDELETED = 0 AND TOTAL_CLC__C  IS NOT NULL AND TOTAL_CLC__C !=0 EXCEPT SELECT PARTY_ID,TOTAL_CLC FROM DM.ACCOUNT_D  WHERE CURRENT_FLAG ='Y' AND STATUS = 'Active' and ISDELETED = 0 AND TOTAL_CLC IS NOT NULL AND TOTAL_CLC !=0
TOTAL_HLC_VALIDATION,SELECT PARTY_ID__C,TOTAL_HLC__C FROM REPO_ODS_SRV.REPO_ODS.SFDC.ACCOUNT WHERE STATUS__C = 'Active' and ISDELETED = 0 AND TOTAL_HLC__C  IS NOT NULL AND TOTAL_HLC__C !=0 EXCEPT SELECT PARTY_ID,TOTAL_HLC FROM DM.ACCOUNT_D  WHERE CURRENT_FLAG ='Y' AND STATUS = 'Active' and ISDELETED = 0 AND TOTAL_HLC IS NOT NULL AND TOTAL_HLC !=0
TOTAL_OFFICE_COUNT,SELECT PARTY_ID,TOTAL_OFFICES FROM DM.ACCOUNT_D WHERE current_flag = 'Y' and delete_flag= 'N' and total_offices !=0 EXCEPT SELECT ACCT.PARTY_ID, OFC_AGNT.OFFICE_COUNT FROM DM.ACCOUNT_D ACCT INNER JOIN(SELECT BROKER_LEVEL.PARENT_ACCOUNT AS ACCOUNT_ID, BROKER_LEVEL.OFFICE_COUNT, ISNULL(SUM(BROKER_LEVEL.AGENT_COUNT),0) AS AGENT_COUNT FROM(SELECT OFF_CNT.OFFICE_COUNT,AG_COUNT.AGENT_COUNT,OFF_CNT.PARENT_ACCOUNT,OFF_CNT.CHILD_ACCOUNT FROM (SELECT C.child_account,OFC_CNT.OFFICE_COUNT,OFC_CNT.PARENT_ACCOUNT FROM DM.ACCOUNT_REL_D C INNER JOIN(SELECT COUNT(*) AS OFFICE_COUNT,OFFICE_COUNT.PARENT_ACCOUNT FROM (SELECT B.PARENT_ACCOUNT FROM DM.ACCOUNT_D A LEFT OUTER JOIN DM.ACCOUNT_REL_D B ON A.ID = B.PARENT_ACCOUNT AND B.RELATIONSHIP_TYPE = 'Parent/Child' AND B.ACTIVE = 1 AND A.TYPE = 'Broker'WHERE A.CURRENT_FLAG = 'Y' AND A.DELETE_FLAG = 'N' ) OFFICE_COUNT GROUP BY OFFICE_COUNT.PARENT_ACCOUNT) OFC_CNT ON OFC_CNT.PARENT_ACCOUNT = C.PARENT_ACCOUNT AND C.RELATIONSHIP_TYPE = 'Parent/Child' AND C.ACTIVE = 1) OFF_CNT LEFT OUTER JOIN(SELECT COUNT(*) AS AGENT_COUNT,AGENT_COUNT.PARENT_ACCOUNT FROM (SELECT B.PARENT_ACCOUNT FROM DM.ACCOUNT_D A LEFT OUTER JOIN DM.ACCOUNT_REL_D B ON A.ID = B.PARENT_ACCOUNT AND B.RELATIONSHIP_TYPE = 'Parent/Child' AND B.ACTIVE = 1 AND A.TYPE = 'Realtor Office'WHERE A.CURRENT_FLAG = 'Y' AND A.DELETE_FLAG = 'N' ) AGENT_COUNT GROUP BY AGENT_COUNT.PARENT_ACCOUNT) AG_COUNT ON AG_COUNT.PARENT_ACCOUNT = OFF_CNT.CHILD_ACCOUNT)BROKER_LEVEL GROUP BY BROKER_LEVEL.PARENT_ACCOUNT,BROKER_LEVEL.OFFICE_COUNT UNION SELECT AGENT_COUNT.PARENT_ACCOUNT AS ACCOUNT_ID,0 AS OFFICE_COUNT, COUNT(*) AS AGENT_COUNT FROM (SELECT B.PARENT_ACCOUNT FROM DM.ACCOUNT_D A LEFT OUTER JOIN DM.ACCOUNT_REL_D B ON A.ID = B.PARENT_ACCOUNT AND B.RELATIONSHIP_TYPE = 'Parent/Child'AND B.ACTIVE = 1 AND A.TYPE = 'Realtor Office'WHERE A.CURRENT_FLAG = 'Y' AND A.DELETE_FLAG = 'N' ) AGENT_COUNT  GROUP BY AGENT_COUNT.PARENT_ACCOUNT ) OFC_AGNT ON ACCT.ID = OFC_AGNT.ACCOUNT_ID AND ACCT.CURRENT_FLAG = 'Y' AND ACCT.DELETE_FLAG = 'N'

*******************************************(BELOW ASSET LEAD QUERY ADDED BY VIJENDRA-03-28-16)*******************************************
DELETED_ASSETS_VALIDATION,select  acnt.id actid, asst.id astid, asst.account_type__C, asst.createddate from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id where asst.status = 'Active'and acnt.status__c = 'Active' and acnt.isdeleted = 0 and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = 0 except select  acnt.id actid, asst.id astid, asst.account_type, asst.createddate from DM.ASSET_D asst inner join  DM.[ACCOUNT_D] acnt on asst.[ACCOUNTID] = acnt.id inner join  DM.[PRODUCT_D] prd on asst.[PRODUCT2ID] = prd.id where asst.status = 'Active' and asst.CURRENT_FLAG ='Y' and asst.DELETE_FLAG = 'N'and acnt.CURRENT_FLAG ='Y' and acnt.DELETE_FLAG = 'N' and acnt.status = 'Active'and asst.asset_type in ('Parent','Fulfill To')
DUPLICATES,SELECT ID,COUNT(*) FROM REPO_ODS_SRV.REPO_ODS.INVENTORY.ASSETLEADDETAIL GROUP BY ID EXCEPT SELECT ID,COUNT(*) FROM DM.ASSET_LEAD_D GROUP BY ID
COUNTS,SELECT COUNT(ID) FROM REPO_ODS_SRV.REPO_ODS.INVENTORY.ASSETLEADDETAIL EXCEPT SELECT COUNT(ID) FROM DM.ASSET_LEAD_D 
PRIMARY_KEY,SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE WHERE OBJECTPROPERTY(OBJECT_ID(CONSTRAINT_SCHEMA + '.' + CONSTRAINT_NAME), 'IsPrimaryKey') = 1 AND TABLE_NAME = 'ORDER_D' AND TABLE_SCHEMA = 'DM' EXCEPT  select COLUMN_NAME from INFORMATION_SCHEMA.COLUMNS where TABLE_SCHEMA IN ('DM') and TABLE_NAME IN ('ASSET_LEAD_D') and column_name = 'ROW_WID'
INDEX,select i.name from sys.tables t inner join sys.schemas s on t.schema_id = s.schema_id inner join sys.indexes i on i.object_id = t.object_id inner join sys.index_columns ic on ic.object_id = t.object_id inner join sys.columns c on c.object_id = t.object_id and ic.column_id = c.column_id where i.index_id > 0     and i.type in (1, 2) and i.is_primary_key = 0  and i.is_unique_constraint = 0  and i.is_disabled = 0 and i.is_hypothetical = 0 and ic.key_ordinal > 0 and t.name = 'ASSET_LEAD_D' and s.name = 'DM' order by ic.key_ordinal
DATA_VALIDATION,select ID,[GUID],SUBMITDATE,ISDUPLICATE,[SOURCE],COMMENT,LEADTYPE,ASSETID,MASTERPROPERTYRECORDID,PROPERTYID,LISTINGPERMANENTLINK,LISTINGADDRESS,LISTINGCITY,LISTINGSTATEID,LISTINGPOSTALCODE,LISTINGSTATUS,LISTINGPRICE,SOURCEEMAILADDRESS,SOURCENAME,SOURCEOFFICENAME,FIRSTNAME,LASTNAME,EMAIL,PHONE,CREATEDATE,UPDATEDATE from REPO_ODS_SRV.REPO_ODS.inventory.assetleaddetail EXCEPT  select ID,[GUID],SUBMITDATE,ISDUPLICATE,[SOURCE],COMMENT,LEADTYPE,ASSETID,MASTERPROPERTYRECORDID,PROPERTYID,LISTINGPERMANENTLINK,LISTINGADDRESS,LISTINGCITY,LISTINGSTATEID,LISTINGPOSTALCODE,LISTINGSTATUS,LISTINGPRICE,SOURCEEMAILADDRESS,SOURCENAME,SOURCEOFFICENAME,FIRSTNAME,LASTNAME,EMAIL,PHONE,CREATEDATE,UPDATEDATE from DM.ASSET_LEAD_D


*******************************************(BELOW INVENTORY QUERY ADDED BY VIJENDRA-03-28-16)*******************************************
DUPLICATE_RECORD,select market,count(*) from dm.geography_d where neighborhoodid is not null group by market having count(*)>1
NULL_POSTALCODE,SELECT * FROM DM.MARKETAVAILABILITY_D WHERE POSTALCODE IS NULL
NULL_GEOGRAPHY_WID,SELECT COUNT(*) FROM DM.INVENTORY_SNAPSHOT_F WHERE GEOGRAPHY_WID IS NULL AND SNPSHOT_DT_WID in (select max(inf.snpshot_dt_wid) from dm.INVENTORY_SNAPSHOT_F inf)
ZERO_GEOGRAPHY_WID,SELECT COUNT(*) FROM DM.INVENTORY_SNAPSHOT_F WHERE GEOGRAPHY_WID = 0 AND SNPSHOT_DT_WID in (select max(inf.snpshot_dt_wid) from dm.INVENTORY_SNAPSHOT_F inf)
COUNT_CITY,SELECT COUNT (DISTINCT MARKET_DISPLAY_NAME) FROM DM.INVENTORY_SNAPSHOT_F  WHERE SNPSHOT_DT_WID  in (select max(inf.snpshot_dt_wid) from dm.INVENTORY_SNAPSHOT_F inf) AND MARKET_TYPE = 'City' except SELECT COUNT(DISTINCT POSTALCODE) FROM [ES_DM].[DM].[MARKETAVAILABILITY_D] MARKAVAIL  where mARKAVAIL.product_type_name = 'City'
COUNT_ZIP,SELECT COUNT (DISTINCT MARKET_DISPLAY_NAME) FROM DM.INVENTORY_SNAPSHOT_F WHERE SNPSHOT_DT_WID in (select max(inf.snpshot_dt_wid) from dm.INVENTORY_SNAPSHOT_F inf) AND MARKET_TYPE = 'Postal Code'except SELECT COUNT(DISTINCT postalcode)FROM [ES_DM].[DM].[MARKETAVAILABILITY_D] MARKAVAIL where mARKAVAIL.product_type_name = 'Postal Code'
MARKETAVAILABILITY_COUNT_MARKETID,SELECT COUNT(*),MARKETID FROM DM.MARKETAVAILABILITY_D GROUP BY MARKETID EXCEPT SELECT COUNT(*),MARKETID FROM REPO_ODS_SRV.REPO_ODS.INVENTORY.MARKETAVAILABILITY_V GROUP BY MARKETID
MARKETAVAILABILITY_COUNT_RECORDS,SELECT COUNT(*) FROM REPO_ODS_SRV.REPO_ODS.INVENTORY.MARKETAVAILABILITY_V  EXCEPT SELECT COUNT(*) FROM DM.MARKETAVAILABILITY_D  
MARKETAVAILABILITY_COUNT_POSTALCODE,SELECT COUNT(*),POSTALCODE FROM REPO_ODS_SRV.REPO_ODS.INVENTORY.MARKETAVAILABILITY_V GROUP BY POSTALCODE EXCEPT SELECT COUNT(*),POSTALCODE FROM DM.MARKETAVAILABILITY_D GROUP BY POSTALCODE
UPDATE_DATA_VALIDATION_FOR_INCREMENTAL_LOAD,select updated_date from dm.inventory_Snapshot_F inv where  inv.snpshot_dt_wid in (select max(inf.snpshot_dt_wid) from dm.INVENTORY_SNAPSHOT_F inf)
BIGSOLD_SMALLSOLD_VALIDATION,select market_display_name,half_price_tier,full_price_tier,big_sold_total,small_sold_total FROM DM.INVENTORY_SNAPSHOT_F WHERE SNPSHOT_DT_WID in (select max(inf.snpshot_dt_wid) from dm.INVENTORY_SNAPSHOT_F inf) and full_price_tier is not null and half_price_tier is not null and big_sold_total is null and small_sold_total is null
TOTAL_RECOMMENDED_QTY_VALIDATION,select market_display_name,(FULL_RECOMMENDED + ( CAST(HALF_RECOMMENDED AS FLOAT(23)) / 2 )) TOTAL_RECOMMENDED_QTY from dm.inventory_Snapshot_F inv where  inv.snpshot_dt_wid in (select max(inf.snpshot_dt_wid) from dm.INVENTORY_SNAPSHOT_F inf) and FULL_RECOMMENDED is not null and half_RECOMMENDED is not null except select market_display_name,TOTAL_RECOMMENDED_QTY from dm.inventory_Snapshot_F inv where  inv.snpshot_dt_wid in (select max(inf.snpshot_dt_wid) from dm.INVENTORY_SNAPSHOT_F inf) and FULL_RECOMMENDED is not null and half_RECOMMENDED is not null
TOTAL_SOLD_FLEX_QUANTITY,select market_display_name,(FULL_FLEX_SOLD + ( CAST(HALF_FLEX_SOLD AS FLOAT(23)) / 2 )) TOTAL_FLEX_SOLD_QTY from dm.inventory_Snapshot_F inv where  inv.snpshot_dt_wid in (select max(inf.snpshot_dt_wid) from dm.INVENTORY_SNAPSHOT_F inf) and FULL_FLEX_SOLD is not null and HALF_FLEX_SOLD is not null except  select  market_display_name,TOTAL_FLEX_SOLD_QTY from dm.inventory_Snapshot_F inv  where  inv.snpshot_dt_wid in (select max(inf.snpshot_dt_wid) from dm.INVENTORY_SNAPSHOT_F inf) and FULL_FLEX_SOLD is not null and HALF_FLEX_SOLD is not null
TOTAL_FAST_SOLD_QUANTITY,select market_display_name,(FULL_FAST_SOLD + ( CAST(HALF_FAST_SOLD AS FLOAT(23)) / 2 )) TOTAL_FAST_SOLD_QTY from dm.inventory_Snapshot_F inv where  inv.snpshot_dt_wid in (select max(inf.snpshot_dt_wid) from dm.INVENTORY_SNAPSHOT_F inf) and FULL_FAST_SOLD is not null and HALF_FAST_SOLD is not null except  select market_display_name,TOTAL_FAST_SOLD_QTY from dm.inventory_Snapshot_F inv where  inv.snpshot_dt_wid in (select max(inf.snpshot_dt_wid) from dm.INVENTORY_SNAPSHOT_F inf) and FULL_FAST_SOLD is not null and HALF_FAST_SOLD is not null
PRODUCT_SOLD_TOTAL_QUANTITY_FLEXEQV,select market_display_name,(TOTAL_FLEX_SOLD_QTY + ( CAST(TOTAL_FAST_SOLD_QTY AS FLOAT(23)) / 2 )) PRODUCT_SOLD_TOTAL_QTY_FLEXEQV from dm.inventory_Snapshot_F inv where  inv.snpshot_dt_wid in (select max(inf.snpshot_dt_wid) from dm.INVENTORY_SNAPSHOT_F inf) and TOTAL_FLEX_SOLD_QTY is not null and TOTAL_FAST_SOLD_QTY is not null except  select  market_display_name,PRODUCT_SOLD_TOTAL_QTY_FLEXEQV from dm.inventory_Snapshot_F inv where  inv.snpshot_dt_wid in (select max(inf.snpshot_dt_wid) from dm.INVENTORY_SNAPSHOT_F inf) and TOTAL_FLEX_SOLD_QTY is not null and TOTAL_FAST_SOLD_QTY is not null
TOTAL_FLEX_AVAILABLE_LOCK_QUANTITY,select market_display_name,(FULL_FLEX_AVAILABLE + ( CAST( HALF_FLEX_AVAILABLE AS FLOAT(23)) / 2 )+FULL_FLEX_LOCK + ( CAST( HALF_FLEX_LOCK AS FLOAT(23)) / 2 )+( CAST( FULL_FAST_LOCK AS FLOAT(23)) / 2 )+( CAST( HALF_FAST_LOCK AS FLOAT(23)) / 4 )) TOTAL_FLEX_AVAILABLE_LOCK_QTY from dm.inventory_Snapshot_F inv where  inv.snpshot_dt_wid in (select max(inf.snpshot_dt_wid) from dm.INVENTORY_SNAPSHOT_F inf) and FULL_FLEX_AVAILABLE IS NOT NULL AND HALF_FLEX_AVAILABLE IS NOT NULL AND FULL_FLEX_LOCK IS NOT NULL AND HALF_FLEX_LOCK IS NOT NULL AND FULL_FAST_LOCK IS NOT NULL AND HALF_FAST_LOCK IS NOT NULL except select market_display_name,TOTAL_FLEX_AVAILABLE_LOCK_QTY from dm.inventory_Snapshot_F inv where  inv.snpshot_dt_wid in (select max(inf.snpshot_dt_wid) from dm.INVENTORY_SNAPSHOT_F inf) and FULL_FLEX_AVAILABLE IS NOT NULL AND HALF_FLEX_AVAILABLE IS NOT NULL  AND FULL_FLEX_LOCK IS NOT NULL AND HALF_FLEX_LOCK IS NOT NULL AND FULL_FAST_LOCK IS NOT NULL AND HALF_FAST_LOCK IS NOT NULL
TOTAL_FAST_AVAILABLE_LOCK_QUANTITY,select market_display_name,(FULL_FAST_AVAILABLE + ( CAST( HALF_FAST_AVAILABLE AS FLOAT(23)) / 2 )+( CAST( FULL_FLEX_LOCK AS FLOAT(23)) * 2 ) +  HALF_FLEX_LOCK + FULL_FAST_LOCK + ( CAST( HALF_FAST_LOCK AS FLOAT(23)) / 2 )) TOTAL_FAST_AVAILABLE_LOCK_QTY from dm.inventory_Snapshot_F inv where  inv.snpshot_dt_wid in (select max(inf.snpshot_dt_wid) from dm.INVENTORY_SNAPSHOT_F inf) and FULL_FAST_AVAILABLE IS NOT NULL AND HALF_FAST_AVAILABLE IS NOT NULL AND FULL_FLEX_LOCK IS NOT NULL AND HALF_FLEX_LOCK IS NOT NULL AND FULL_FAST_LOCK IS NOT NULL AND HALF_FAST_LOCK IS NOT NULL except select  market_display_name,TOTAL_FAST_AVAILABLE_LOCK_QTY from dm.inventory_Snapshot_F inv where  inv.snpshot_dt_wid in (select max(inf.snpshot_dt_wid) from dm.INVENTORY_SNAPSHOT_F inf) and FULL_FAST_AVAILABLE IS NOT NULL AND HALF_FAST_AVAILABLE IS NOT NULL AND FULL_FLEX_LOCK IS NOT NULL AND HALF_FLEX_LOCK IS NOT NULL AND FULL_FAST_LOCK IS NOT NULL AND HALF_FAST_LOCK IS NOT NULL
FLEX_SELL_THRU,select market_display_name,ROUND( ( CAST( PRODUCT_SOLD_TOTAL_QTY_FLEXEQV AS FLOAT(23)))/( CAST( TOTAL_RECOMMENDED_QTY AS FLOAT(23))),3 ) FLEX_SELL_THRU from dm.inventory_Snapshot_F inv where  inv.snpshot_dt_wid in (select max(inf.snpshot_dt_wid) from dm.INVENTORY_SNAPSHOT_F inf) and TOTAL_RECOMMENDED_QTY IS NOT NULL AND TOTAL_RECOMMENDED_QTY !=0 AND PRODUCT_SOLD_TOTAL_QTY_FLEXEQV IS NOT NULL except select market_display_name,FLEX_SELL_THRU from dm.inventory_Snapshot_F inv where  inv.snpshot_dt_wid in (select max(inf.snpshot_dt_wid) from dm.INVENTORY_SNAPSHOT_F inf) and TOTAL_RECOMMENDED_QTY IS NOT NULL AND TOTAL_RECOMMENDED_QTY !=0 AND PRODUCT_SOLD_TOTAL_QTY_FLEXEQV IS NOT NULL AND FLEX_SELL_THRU IS NOT NULL 
DATA_VALIDATIONS,select mrkavail.POSTALCODE as market,sum(case when mrkavail.product_size_name = 'Half' THEN mrkavail.QUANTITYTIER END) as HALF_RECOMMENDED,sum(case when mrkavail.product_size_name = 'Half' THEN mrkavail.PRICETIER END) as HALF_PRICE_TIER,sum(case when mrkavail.product_size_name = 'Half'THEN mrkavail.FLEX_TOTALQUANTITY END) as HALF_FLEX_TOTAL_QTY,sum(case when mrkavail.product_size_name = 'Half' THEN mrkavail.FLEX_SOLD END) as HALF_FLEX_SOLD,sum(case when mrkavail.product_size_name = 'Half' THEN mrkavail.FLEX_LOCK END) as HALF_FLEX_LOCK,sum(case when mrkavail.product_size_name = 'Half' THEN mrkavail.FLEX_AVAILABLE END) as HALF_FLEX_AVAILABLE,sum(case when mrkavail.product_size_name = 'Half' THEN mrkavail.FAST_TOTALQUANTITY END) as HALF_FAST_TOTAL_QTY,sum(case when mrkavail.product_size_name = 'Half' THEN mrkavail.FAST_SOLD END) as HALF_FAST_SOLD,sum(case when mrkavail.product_size_name = 'Half' THEN mrkavail.FAST_LOCK END) as HALF_FAST_LOCK,sum(case when mrkavail.product_size_name = 'Half' THEN mrkavail.FAST_AVAILABLE END) as HALF_FAST_AVAILABLE,max(case when mrkavail.product_size_name = 'Half' THEN mrkavail.FLEX_LASTSOLD END) as HALF_FLEX_LASTSOLD,max(case when mrkavail.product_size_name = 'Half' THEN mrkavail.FAST_LASTSOLD END) as HALF_FAST_LASTSOLD,sum(case when mrkavail.product_size_name = 'Full' THEN mrkavail.QUANTITYTIER END) as FULL_RECOMMENDED,sum(case when mrkavail.product_size_name = 'Full' THEN mrkavail.PRICETIER END) as FULL_PRICE_TIER,sum(case when mrkavail.product_size_name = 'Full' THEN mrkavail.FLEX_TOTALQUANTITY END) as FULL_FLEX_TOTAL_QTY,sum(case when mrkavail.product_size_name = 'Full' THEN mrkavail.FLEX_SOLD END) as FULL_FLEX_SOLD,sum(case when mrkavail.product_size_name = 'Full' THEN mrkavail.FLEX_LOCK END) as FULL_FLEX_LOCK,sum(case when mrkavail.product_size_name = 'Full' THEN mrkavail.FLEX_AVAILABLE END) as FULL_FLEX_AVAILABLE,sum(case when mrkavail.product_size_name = 'Full' THEN mrkavail.FAST_TOTALQUANTITY END) as FULL_FAST_TOTAL_QTY,sum(case when mrkavail.product_size_name = 'Full' THEN mrkavail.FAST_SOLD END) as FULL_FAST_SOLD,sum(case when mrkavail.product_size_name = 'Full' THEN mrkavail.FAST_LOCK END) as FULL_FAST_LOCK ,sum(case when mrkavail.product_size_name = 'Full' THEN mrkavail.FAST_AVAILABLE END) as FULL_FAST_AVAILABLE,max(case when mrkavail.product_size_name = 'Full' THEN mrkavail.FLEX_LASTSOLD END) as FULL_FLEX_LASTSOLD,max(case when mrkavail.product_size_name = 'Full' THEN mrkavail.FAST_LASTSOLD END) as FULL_FAST_LASTSOLD from dm.marketavailability_d mrkavail where  mrkavail.postalcode not in ('00001','00002','00003','00004','00005','00006','00007','00008','00009','00010','00011','00012','00013','00014','00015','00016','00017','00018','00019','00020')group by mrkavail.POSTALCODE except select INV.MARKET_DISPLAY_NAME,sum([HALF_RECOMMENDED]) as [HALF_RECOMMENDED],sum([HALF_PRICE_TIER]) as  [HALF_PRICE_TIER],sum([HALF_FLEX_TOTAL_QTY]) as [HALF_FLEX_TOTAL_QTY],sum([HALF_FLEX_SOLD]) as [HALF_FLEX_SOLD],sum([HALF_FLEX_LOCK]) as [HALF_FLEX_LOCK],sum([HALF_FLEX_AVAILABLE]) as [HALF_FLEX_AVAILABLE],sum([HALF_FAST_TOTAL_QTY]) as [HALF_FAST_TOTAL_QTY],sum([HALF_FAST_SOLD]) as [HALF_FAST_SOLD],sum([HALF_FAST_LOCK]) as [HALF_FAST_LOCK],sum([HALF_FAST_AVAILABLE]) as [HALF_FAST_AVAILABLE],max([HALF_FLEX_LASTSOLD_DATE]) as [HALF_FLEX_LASTSOLD],max([HALF_FAST_LASTSOLD_DATE]) as [HALF_FAST_LASTSOLD],sum([FULL_RECOMMENDED]) as [FULL_RECOMMENDED],sum([FULL_PRICE_TIER]) as [FULL_PRICE_TIER],sum([FULL_FLEX_TOTAL_QTY]) as [FULL_FLEX_TOTAL_QTY],sum([FULL_FLEX_SOLD]) as [FULL_FLEX_SOLD],sum([FULL_FLEX_LOCK]) as [FULL_FLEX_LOCK],sum([FULL_FLEX_AVAILABLE]) as [FULL_FLEX_AVAILABLE],sum([FULL_FAST_TOTAL_QTY]) as [FULL_FAST_TOTAL_QTY],sum([FULL_FAST_SOLD]) as [FULL_FAST_SOLD],sum([FULL_FAST_LOCK]) as [FULL_FAST_LOCK],sum([FULL_FAST_AVAILABLE]) as [FULL_FAST_AVAILABLE],max([FULL_FLEX_LASTSOLD_DATE]) as [FULL_FLEX_LASTSOLD],max([FULL_FAST_LASTSOLD_DATE]) as [FULL_FAST_LASTSOLD]from dm.inventory_Snapshot_F inv where  inv.snpshot_dt_wid in (select max(inf.snpshot_dt_wid) from dm.INVENTORY_SNAPSHOT_F inf)and INV.market_DISPLAY_NAME not in ('00001','00002','00003','00004','00005','00006','00007','00008','00009','00010','00011','00012','00013','00014','00015','00016','00017','00018','00019','00020') group by INV.MARKET_DISPLAY_NAME;
SUM_VALUES_VALIDATION,SELECT count (distinct MARKAVAIL.POSTALCODE) as POSTAL_CODE,sum(case when product_size_name = 'Half' THEN MARKAVAIL.QUANTITYTIER END) as HALF_RECOMMENDED,sum(case when product_size_name = 'Half' THEN MARKAVAIL.PRICETIER END) as HALF_PRICE_TIER,sum(case when product_size_name = 'Half' THEN MARKAVAIL.FLEX_TOTALQUANTITY END) as HALF_FLEX_TOTAL_QTY,sum(case when product_size_name = 'Half' THEN MARKAVAIL.FLEX_SOLD END) as HALF_FLEX_SOLD,sum(case when product_size_name = 'Half' THEN MARKAVAIL.FLEX_LOCK END) as HALF_FLEX_LOCK,sum(case when product_size_name = 'Half' THEN MARKAVAIL.FLEX_AVAILABLE END) as HALF_FLEX_AVAILABLE,sum(case when product_size_name = 'Half' THEN MARKAVAIL.FAST_TOTALQUANTITY END) as HALF_FAST_TOTAL_QTY,sum(case when product_size_name = 'Half' THEN MARKAVAIL.FAST_SOLD END) as HALF_FAST_SOLD,sum(case when product_size_name = 'Half' THEN MARKAVAIL.FAST_LOCK END) as HALF_FAST_LOCK,sum(case when product_size_name = 'Half' THEN MARKAVAIL.FAST_AVAILABLE END) as HALF_FAST_AVAILABLE,sum(case when product_size_name = 'Full' THEN MARKAVAIL.QUANTITYTIER END) as FULL_RECOMMENDED,sum(case when product_size_name = 'Full' THEN MARKAVAIL.PRICETIER END) as FULL_PRICE_TIER,sum(case when product_size_name = 'Full' THEN MARKAVAIL.FLEX_TOTALQUANTITY END) as FULL_FLEX_TOTAL_QTY,sum(case when product_size_name = 'Full' THEN MARKAVAIL.FLEX_SOLD END) as FULL_FLEX_SOLD,sum(case when product_size_name = 'Full' THEN MARKAVAIL.FLEX_LOCK END) as FULL_FLEX_LOCK,sum(case when product_size_name = 'Full' THEN MARKAVAIL.FLEX_AVAILABLE END) as FULL_FLEX_AVAILABLE,sum(case when product_size_name = 'Full' THEN MARKAVAIL.FAST_TOTALQUANTITY END) as FULL_FAST_TOTAL_QTY,sum(case when product_size_name = 'Full' THEN MARKAVAIL.FAST_SOLD END) as FULL_FAST_SOLD,sum(case when product_size_name = 'Full' THEN MARKAVAIL.FAST_LOCK END) as FULL_FAST_LOCK,sum(case when product_size_name = 'Full' THEN MARKAVAIL.FAST_AVAILABLE END) as FULL_FAST_AVAILABLE FROM [ES_DM].[DM].[MARKETAVAILABILITY_D] MARKAVAIL where  markavail.postalcode not in ('00001','00002','00003','00004','00005','00006','00007','00008','00009','00010','00011','00012','00013','00014','00015','00016','00017','00018','00019','00020')except select COUNT(distinct(INV.MARKET_DISPLAY_NAME)),sum([HALF_RECOMMENDED]) as [HALF_RECOMMENDED],sum([HALF_PRICE_TIER]) as  [HALF_PRICE_TIER],sum([HALF_FLEX_TOTAL_QTY]) as [HALF_FLEX_TOTAL_QTY],sum([HALF_FLEX_SOLD]) as [HALF_FLEX_SOLD],sum([HALF_FLEX_LOCK]) as [HALF_FLEX_LOCK],sum([HALF_FLEX_AVAILABLE]) as [HALF_FLEX_AVAILABLE],sum([HALF_FAST_TOTAL_QTY]) as [HALF_FAST_TOTAL_QTY],sum([HALF_FAST_SOLD]) as [HALF_FAST_SOLD],sum([HALF_FAST_LOCK]) as [HALF_FAST_LOCK],sum([HALF_FAST_AVAILABLE]) as [HALF_FAST_AVAILABLE],sum([FULL_RECOMMENDED]) as [FULL_RECOMMENDED],sum([FULL_PRICE_TIER]) as [FULL_PRICE_TIER],sum([FULL_FLEX_TOTAL_QTY]) as [FULL_FLEX_TOTAL_QTY],sum([FULL_FLEX_SOLD]) as [FULL_FLEX_SOLD],sum([FULL_FLEX_LOCK]) as [FULL_FLEX_LOCK],sum([FULL_FLEX_AVAILABLE]) as [FULL_FLEX_AVAILABLE],sum([FULL_FAST_TOTAL_QTY]) as [FULL_FAST_TOTAL_QTY],sum([FULL_FAST_SOLD]) as [FULL_FAST_SOLD],sum([FULL_FAST_LOCK]) as [FULL_FAST_LOCK],sum([FULL_FAST_AVAILABLE]) as [FULL_FAST_AVAILABLE]from dm.inventory_Snapshot_F INV WHERE SNPSHOT_DT_WID in (select max(inf.snpshot_dt_wid) from dm.INVENTORY_SNAPSHOT_F inf) and INV.market_DISPLAY_NAME not in ('00001','00002','00003','00004','00005','00006','00007','00008','00009','00010','00011','00012','00013','00014','00015','00016','00017','00018','00019','00020')

*******************************************(BELOW OPPORTUNITY QUERY ADDED BY VIJENDRA-03-28-16)*******************************************
OPPORTUNITY_D_DUPLICATE,SELECT ID,COUNT(*) FROM REPO_ODS_SRV.REPO_ODS.SFDC.OPPORTUNITY GROUP BY ID EXCEPT SELECT ID,COUNT(*) FROM DM.OPPORTUNITY_D WHERE CURRENT_FLAG = 'Y' AND DELETE_FLAG = 'N' GROUP BY ID
OPPORTUNITY_D_COUNTS,SELECT COUNT(*) FROM REPO_ODS_SRV.REPO_ODS.SFDC.OPPORTUNITY EXCEPT SELECT COUNT(*) FROM DM.OPPORTUNITY_D WHERE CURRENT_FLAG = 'Y' AND DELETE_FLAG = 'N'
OPPORTUNITY_D_DUPLICATE_COUNT,SELECT ID,COUNT(*) FROM REPO_ODS_SRV.REPO_ODS.SFDC.OPPORTUNITY GROUP BY ID having count(*)>1 EXCEPT SELECT ID,COUNT(*) FROM DM.OPPORTUNITY_D WHERE CURRENT_FLAG = 'Y' AND DELETE_FLAG = 'N' GROUP BY ID having count(*)>1
OPPORTUNITY_D_COLUMN_DATA_TYPE_AND_LENGTH_VALIDATION,select DATA_TYPE,CHARACTER_MAXIMUM_LENGTH from REPO_ODS_SRV.REPO_ODS.INFORMATION_SCHEMA.COLUMNS where TABLE_SCHEMA = 'SFDC' and TABLE_NAME = 'OPPORTUNITY' AND COLUMN_NAME IN  ('ID','ISDELETED','ACCOUNTID','RECORDTYPEID','NAME','STAGENAME','AMOUNT','PROBABILITY','CLOSEDATE','TYPE','NEXTSTEP','LEADSOURCE','ISCLOSED','ISWON','FORECASTCATEGORY','Forecast_Cat__C','CAMPAIGNID','HASOPPORTUNITYLINEITEM','PRICEBOOK2ID','OWNERID','CREATEDDATE','CREATEDBYID','LASTMODIFIEDDATE','LASTMODIFIEDBYID','SYSTEMMODSTAMP','LASTACTIVITYDATE','FISCALQUARTER','FISCALYEAR','FISCAL','LASTVIEWEDDATE','LASTREFERENCEDDATE','SYNCEDQUOTEId')EXCEPT select DATA_TYPE,CHARACTER_MAXIMUM_LENGTH from INFORMATION_SCHEMA.COLUMNS where TABLE_SCHEMA = 'DM' and TABLE_NAME = 'OPPORTUNITY_D' AND COLUMN_NAME IN ('ID','ISDELETED','ACCOUNTID','RECORDTYPEID','NAME','STAGENAME','AMOUNT','PROBABILITY','CLOSEDATE','TYPE','NEXTSTEP','LEADSOURCE','ISCLOSED','ISWON','FORECASTCATEGORY','FORECASTCATEGORYNAME','CAMPAIGNID','HASOPPORTUNITYLINEITEM','PRICEBOOK2ID','OWNERID','CREATEDDATE','CREATEDBYID','LASTMODIFIEDDATE','LASTMODIFIEDBYID','SYSTEMMODSTAMP','LASTACTIVITYDATE','FISCALQUARTER','FISCALYEAR','FISCAL','LASTVIEWEDDATE','LASTREFERENCEDDATE','SYNCEDQUOTEID')
OPPORTUNITY_D_PRIMARY_KEY,SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE WHERE OBJECTPROPERTY(OBJECT_ID(CONSTRAINT_SCHEMA + '.' + CONSTRAINT_NAME), 'IsPrimaryKey') = 1 AND TABLE_NAME = 'OPPORTUNITY_D' AND TABLE_SCHEMA = 'DM' EXCEPT  select COLUMN_NAME from INFORMATION_SCHEMA.COLUMNS where TABLE_SCHEMA IN ('DM') and TABLE_NAME IN ('OPPORTUNITY_D') and column_name = 'ROW_WID'
OPPORTUNITY_D_INDEX,select i.name from sys.tables t inner join sys.schemas s on t.schema_id = s.schema_id inner join sys.indexes i on i.object_id = t.object_id inner join sys.index_columns ic on ic.object_id = t.object_id inner join sys.columns c on c.object_id = t.object_id and ic.column_id = c.column_id where i.index_id > 0     and i.type in (1, 2) and i.is_primary_key = 0  and i.is_unique_constraint = 0  and i.is_disabled = 0 and i.is_hypothetical = 0 and ic.key_ordinal > 0 and t.name = 'OPPORTUNITY_D' and s.name = 'DM' order by ic.key_ordinal
OPPORTUNITY_D_DATA_VALIDATION,select ID,ISDELETED,ACCOUNTID,RECORDTYPEID,NAME,STAGENAME,AMOUNT,PROBABILITY,CLOSEDATE,TYPE,NEXTSTEP,LEADSOURCE,ISCLOSED,ISWON,FORECASTCATEGORY,Forecast_Cat__C,CAMPAIGNID,HASOPPORTUNITYLINEITEM,PRICEBOOK2ID,OWNERID,CREATEDDATE,CREATEDBYID,LASTMODIFIEDDATE,LASTMODIFIEDBYID,SYSTEMMODSTAMP,LASTACTIVITYDATE,FISCALQUARTER,FISCALYEAR,FISCAL,LASTVIEWEDDATE,LASTREFERENCEDDATE,SYNCEDQUOTEId from REPO_ODS_SRV.REPO_ODS.sfdc.opportunity EXCEPT select ID,ISDELETED,ACCOUNTID,RECORDTYPEID,NAME,STAGENAME,AMOUNT,PROBABILITY,CLOSEDATE,TYPE,NEXTSTEP,LEADSOURCE,ISCLOSED,ISWON,FORECASTCATEGORY,FORECASTCATEGORYNAME,CAMPAIGNID,HASOPPORTUNITYLINEITEM,PRICEBOOK2ID,OWNERID,CREATEDDATE,CREATEDBYID,LASTMODIFIEDDATE,LASTMODIFIEDBYID,SYSTEMMODSTAMP,LASTACTIVITYDATE,FISCALQUARTER,FISCALYEAR,FISCAL,LASTVIEWEDDATE,LASTREFERENCEDDATE,SYNCEDQUOTEID from DM.opportunity_D
OPPORTUNITY_LINE_ITEM_D_DUPLICATE,SELECT ID,COUNT(*) FROM REPO_ODS_SRV.REPO_ODS.SFDC.OPPORTUNITYLINEITEM GROUP BY ID EXCEPT SELECT ID,COUNT(*) FROM DM.OPPORTUNITY_LINE_ITEM_D WHERE DELETE_FLAG = 'N' GROUP BY ID
OPPORTUNITY_LINE_ITEM_D_COUNTS,SELECT COUNT(ID) FROM REPO_ODS_SRV.REPO_ODS.SFDC.OPPORTUNITYLINEITEM EXCEPT SELECT COUNT(ID) FROM DM.OPPORTUNITY_LINE_ITEM_D WHERE DELETE_FLAG = 'N'
OPPORTUNITY_LINE_ITEM_D_DUPLICATE_COUNT,SELECT ID,COUNT(*) FROM REPO_ODS_SRV.REPO_ODS.SFDC.OPPORTUNITYLINEITEM GROUP BY ID having count(*)>1 EXCEPT SELECT ID,COUNT(*) FROM DM.OPPORTUNITY_LINE_ITEM_D WHERE DELETE_FLAG = 'N'GROUP BY ID having count(*)>1
OPPORTUNITY_LINE_ITEM_D_COLUMN_DATATYPE_LENGTH_VALIDATION,select DATA_TYPE,CHARACTER_MAXIMUM_LENGTH from REPO_ODS_SRV.REPO_ODS.INFORMATION_SCHEMA.COLUMNS where TABLE_SCHEMA = 'SFDC' and TABLE_NAME = 'OPPORTUNITYLINEITEM' AND COLUMN_NAME IN ('ID','OPPORTUNITYID','SORTORDER','PRICEBOOKENTRYID','PRODUCT2ID','PRODUCTCODE','NAME','QUANTITY','TOTALPRICE','UNITPRICE','LISTPRICE','SERVICEDATE','DESCRIPTION','CREATEDDATE','CREATEDBYID','LASTMODIFIEDDATE','LASTMODIFIEDBYID','SYSTEMMODSTAMP','ISDELETED','ASSET__C','PRODUCT_NAME__C','TIGERLEAD__C','DAP__C','TOP_PRODUCER__C')EXCEPT select DATA_TYPE,CHARACTER_MAXIMUM_LENGTH from INFORMATION_SCHEMA.COLUMNS where TABLE_SCHEMA = 'DM' and TABLE_NAME = 'OPPORTUNITY_LINE_ITEM_D' AND COLUMN_NAME IN (' ID','OPPORTUNITY_ID','SORTORDER','PRICE_BOOK_ENTRY_ID','PRODUCT_ID','PRODUCT_CODE','NAME','QUANTITY','TOTAL_PRICE','UNIT_PRICE','LIST_PRICE','SERVICE_DATE','DESCRIPTION','CREATEDDATE','CREATEDBYID','LASTMODIFIEDDATE','LASTMODIFIEDBYID','SYSTEMMODSTAMP','ISDELETED','ASSET_ID','PRODUCT_NAME','TIGERLEAD_FLAG','DAP_FLAG','TOP_PRODUCER')
OPPORTUNITY_LINE_ITEM_D_PRIMARY_KEY,SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE WHERE OBJECTPROPERTY(OBJECT_ID(CONSTRAINT_SCHEMA + '.' + CONSTRAINT_NAME), 'IsPrimaryKey') = 1 AND TABLE_NAME = 'OPPORTUNITY_LINE_ITEM_D' AND TABLE_SCHEMA = 'DM' EXCEPT  select COLUMN_NAME from INFORMATION_SCHEMA.COLUMNS where TABLE_SCHEMA IN ('DM') and TABLE_NAME IN ('OPPORTUNITY_LINE_ITEM_D') and column_name = 'ROW_WID'
OPPORTUNITY_LINE_ITEM_D_INDEX,select i.name from sys.tables t inner join sys.schemas s on t.schema_id = s.schema_id inner join sys.indexes i on i.object_id = t.object_id inner join sys.index_columns ic on ic.object_id = t.object_id inner join sys.columns c on c.object_id = t.object_id  and ic.column_id = c.column_id where i.index_id > 0 and i.type in (1, 2) and i.is_primary_key = 0  and i.is_unique_constraint = 0 and i.is_disabled = 0 and i.is_hypothetical = 0 and ic.key_ordinal > 0 and t.name = 'OPPORTUNITY_LINE_ITEM_D' and s.name = 'DM' order by ic.key_ordinal
OPPORTUNITY_LINE_ITEM_D_DATA_VALIDATION,SELECT ID,OPPORTUNITYID,SORTORDER,PRICEBOOKENTRYID,PRODUCT2ID,PRODUCTCODE,NAME,QUANTITY,TOTALPRICE,UNITPRICE,LISTPRICE,SERVICEDATE,DESCRIPTION,CREATEDDATE,CREATEDBYID,LASTMODIFIEDDATE,LASTMODIFIEDBYID,SYSTEMMODSTAMP,ISDELETED,ASSET__C,PRODUCT_NAME__C,TIGERLEAD__C,DAP__C,TOP_PRODUCER__C from REPO_ODS_SRV.REPO_ODS.SFDC.OPPORTUNITYLINEITEM EXCEPT  select ID,OPPORTUNITY_ID,SORTORDER,PRICE_BOOK_ENTRY_ID,PRODUCT_ID,PRODUCT_CODE,NAME,QUANTITY,TOTAL_PRICE,UNIT_PRICE,LIST_PRICE,SERVICE_DATE,DESCRIPTION,CREATEDDATE,CREATEDBYID,LASTMODIFIEDDATE,LASTMODIFIEDBYID,SYSTEMMODSTAMP,ISDELETED,ASSET_ID,PRODUCT_NAME,TIGERLEAD_FLAG,DAP_FLAG,TOP_PRODUCER from DM.OPPORTUNITY_LINE_ITEM_D
OPPORTUBITY_F_DATA_VALIDATION,SELECT OPTY_D.ROW_WID AS OPPORTUNITY_WID,OPTY_D.ID AS OPPORTUNITY_ID,OPTY_LINE.PRODUCT2ID AS PRODUCT_ID,CONVERT(VARCHAR(10),OPTY_D.CREATEDDATE,112),CONVERT(VARCHAR(10),OPTY_D.CLOSEDATE,112),usr.row_wid,OPTY_D.OWNERID AS OPPORTUNITY_OWNER_ID,OPTY_D.AMOUNT AS OPPORTUNITY_AMT,OPTY_LINE.SORTORDER AS LINE_ITEM_ORDER,OPTY_LINE.PRICEBOOKENTRYID,OPTY_LINE.PRODUCTCODE,OPTY_LINE.NAME,OPTY_LINE.QUANTITY,OPTY_LINE.TOTALPRICE,OPTY_LINE.UNITPRICE,OPTY_LINE.LISTPRICE,OPTY_LINE.SERVICEDATE,OPTY_LINE.DESCRIPTION,AST.id,OPTY_LINE.TIGERLEAD__C AS TIGERLEAD_Flag,OPTY_LINE.DAP__C AS DAP_Flag,OPTY_D.ACCOUNTID AS ACCOUNT_ID,QUOTE_LINE.TOTAL_DISCOUNT,QUOTE_LINE.PROMOTION_AMOUNT,QUOTE_LINE.MARKET,QUOTE_LINE.MANUAL_OVERRIDE_AMOUNT,(case QUOTE_LINE.LINE_TYPE when  'Add' THEN 'New'when  'Amend' THEN 'Modify'when  'Renew' THEN 'Renew'else QUOTE_LINE.LINE_TYPE END) AS LINE_TYPE,OPTY_LINE.ID AS OPTY_LINE_ITEM_ID,QUOTE_LINE.ID AS QUOTE_LINE_ITEM_ID,QUOTE_LINE.BIGMACHINES__QUOTE,AST.ASSET_AMEND_TYPE AS LINE_SUBTYPE FROM DM.OPPORTUNITYLINEITEM_S AS OPTY_LINE LEFT JOIN DM.OPPORTUNITY_D AS OPTY_D ON OPTY_LINE.OPPORTUNITYID = OPTY_D.ID left join dm.user_d usr on usr.id=opty_d.OWNERID LEFT JOIN  DM.BIGMACHINES__QUOTE_PRODUCT_S AS QUOTE_LINE ON OPTY_LINE.BIGMACHINES__SYNCHRONIZATION_ID__C = QUOTE_LINE.BIGMACHINES__SYNCHRONIZATION_ID LEFT JOIN DM.ASSET_D AST on QUOTE_LINE.ASSET = AST.ID WHERE OPTY_D.CURRENT_FLAG= 'Y' AND OPTY_D.DELETE_FLAG = 'N' AND AST.CURRENT_FLAG = 'Y' AND AST.DELETE_FLAG = 'N' AND QUOTE_LINE.ISDELETED = '0'  EXCEPT SELECT OPPORTUNITY_WID,OPPORTUNITY_ID,PRODUCT_ID,CREATED_DATE_WID,CLOSE_DATE_WID,OPPORTUNITY_OWNER_WID,OPPORTUNITY_OWNER_ID,OPPORTUNITY_AMT,LINE_ITEM_ORDER,PRICEBOOKENTRYID,PRODUCTCODE,NAME,QUANTITY,TOTALPRICE,UNITPRICE,LISTPRICE,SERVICEDATE,DESCRIPTION,ASSET_ID,TIGERLEAD_Flag,DAP_Flag,ACCOUNT_ID,TOTAL_DISCOUNT,PROMOTION_AMOUNT,MARKET,MANUAL_OVERRIDE_AMOUNT,LINE_TYPE,OPTY_LINE_ITEM_ID,QUOTE_LINE_ITEM_ID,QUOTE_ID,LINE_SUBTYPE  FROM DM.OPPORTUNITY_F
OPPORTUBITY_F_DATA_VALIDATION_QUOTA_WID,select A.ROW_WID from dm.quota_d a  inner join dm.opportunity_d b on a.PERIOD_MONTH = datename(month,CONVERT(VARCHAR(10),CLOSEDATE,112))and  A.PERIOD_YEAR = YEAR(CONVERT(VARCHAR(10),B.CLOSEDATE,112))and A.QUOTA_USER_ID = B.OWNERID except select quota_wid from dm.opportunity_f

*******************************************(BELOW PRODUCT FLAG QUERY ADDED BY VIJENDRA-03-28-16)*******************************************
Connection(SM)_for_Co_Brokerage,select  prd.name, count(*)from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0'and prd.name = 'Connection(SM) for Co-Brokerage'group by prd.name except select 'Connection(SM) for Co-Brokerage', sum(acnt.[OWN_CO_BROKE__C]) from  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt inner join (select acnt.id acntid from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0')ast  on acnt.id = ast.acntid
Showcase_Listing_(SLE),select  prd.name, count(*)from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0'and prd.name = 'Showcase(SM) Listing Enhancements'group by prd.name except select 'Showcase(SM) Listing Enhancements', sum(acnt.[OWN_SLE__C])from  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt inner join (select acnt.id acntid from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0')ast  on acnt.id = ast.acntid
OWN_COSHOW,select 'OWN_COSHOW',COUNT(*) from repo_ods_srv.repo_ods.[cdh].[move_mls_hierarchy_v] mls where mls.office_mls_set_id in (select  acnt1.mls_set_id__C from repo_ods_srv.[REPO_ODS].[SFDC].[ACCOUNT] acnt1 inner join repo_ods_srv.[REPO_ODS].[SFDC].[ASSET] asst on asst.accountid = acnt1.id inner join repo_ods_srv.[REPO_ODS].[SFDC].[ASSET] partAsst on partAsst.parent_asset__C = asst.id inner join  repo_ods_srv.repo_ods.[cdh].[move_mls_hierarchy_v] mls on mls.office_mls_set_id = acnt1.mls_set_id__C where acnt1.id in (select acntRel.[CHILD_ACCOUNT__C]from repo_ods_srv.[REPO_ODS].[SFDC].[ASSET] asst inner join  repo_ods_srv.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id inner join  repo_ods_srv.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id inner join repo_ods_srv.[REPO_ODS].[SFDC].[ACCOUNT_RELATIONSHIP__C] acntRel on acnt.id = acntRel.parent_account__C where asst.status = 'Active'and acntRel.[RELATIONSHIP_TYPE__C] = 'Parent/Child'and asst.asset_type__C in ('Parent','Fulfill To')and prd.productcode = 'SHOWCASE'and asst.account_type__C = 'Broker')and partAsst.asset_type__C = 'Participant'and partAsst.status = 'Active' and mls.status = 'A')except select 'OWN_COSHOW', sum(acnt.[OWN_COSHOW__C])from  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt inner join (select acnt.id acntid from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0')ast  on acnt.id = ast.acntid
Digital_Ad_Package,select  prd.name, count(*)from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0'and prd.name = 'Digital Ad Package' group by prd.name except select 'Digital Ad Package', sum(acnt.[OWN_DAP__C])from  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt inner join (select acnt.id acntid from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0')ast  on acnt.id = ast.acntid
Featured_Display,select  prd.name, count(*) from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id   inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0'and prd.name = 'Featured Display'group by prd.name except select 'Featured Display', sum(acnt.[OWN_FAC__C])from  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt inner join (select acnt.id acntid from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0')ast  on acnt.id = ast.acntid
Featured_CMA(SM),select  prd.name, count(*)from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id   inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0'and prd.name = 'Featured CMA(SM)'group by prd.name except select 'Featured CMA(SM)', sum(acnt.[OWN_FCMA__C])from  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt inner join (select acnt.id acntid from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0')ast  on acnt.id = ast.acntid
Featured_Homes(SM),select  prd.name, count(*) from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0'and prd.name = 'Featured Homes(SM)'group by prd.name except select 'Featured Homes(SM)', sum(acnt.[OWN_FH__C])from  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt inner join (select acnt.id acntid from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id  where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0')ast  on acnt.id = ast.acntid
Five_Street,select  prd.name, count(*) from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id  where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0'and prd.name = 'FiveStreet'group by prd.name except select 'FiveStreet', sum(acnt.[OWN_FS__C]) from  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt inner join (select acnt.id acntid from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id  where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0')ast  on acnt.id = ast.acntid
Top_Producer_CRM,select  prd.name, count(*)  from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id  where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0'and prd.name = 'Top Producer CRM'group by prd.name except select 'Top Producer CRM', sum(acnt.[OWN_TP_CRM__C])from  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt inner join (select acnt.id acntid from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id  where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0')ast  on acnt.id = ast.acntid
Top_Producer_IDX,select  prd.name, count(*)  from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id  where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0'and prd.name = 'Top Producer IDX'group by prd.name except select 'Top Producer IDX', sum(acnt.[OWN_IDX__C])from  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt inner join (select acnt.id acntid from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id  where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0')ast  on acnt.id = ast.acntid
Market_Snapshot,select  prd.name, count(*)  from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id  where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0'and prd.name = 'Market Snapshot'group by prd.name except select 'Market Snapshot', sum(acnt.[OWN_MS__C])from  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt inner join (select acnt.id acntid from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id  where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0')ast  on acnt.id = ast.acntid
Digital_Ad_Campaign,select  prd.name, count(*)from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id  where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0'and prd.name = 'Digital Advertising Campaign'group by prd.name except select 'Digital Advertising Campaign', sum(acnt.[OWN_DAC__C])from  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt inner join (select acnt.id acntid from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id  where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0')ast  on acnt.id = ast.acntid
Domain_Name,select  prd.name, count(*)  from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id  where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0'and prd.name = 'Domain Name'group by prd.name except select 'Domain Name', sum(acnt.[Own_Domain_Name__C]) from  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt inner join (select acnt.id acntid from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0')ast  on acnt.id = ast.acntid
DoorSteps,select  prd.name, count(*)  from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id  where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0'and prd.name = 'Doorsteps'group by prd.name  except select 'Doorsteps', sum(acnt.[Own_Doorsteps__C])from  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt inner join (select acnt.id acntid from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id  where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0')ast  on acnt.id = ast.acntid
ListHub_Pro,select  prd.name, count(*)  from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id  where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0'and prd.name = 'ListHub Pro'group by prd.name except select 'ListHub Pro', sum(acnt.[OWN_LH__C])from  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt inner join (select acnt.id acntid from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0')ast  on acnt.id = ast.acntid
Market_Builder,select  prd.name, count(*) from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id  where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0'and prd.name = 'Market Builder'group by prd.name  except select 'Market Builder', sum(acnt.[Own_Market_Builder__C])from  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt inner join (select acnt.id acntid from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id  where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0')ast  on acnt.id = ast.acntid
Sign_Rider,select  prd.name, count(*) from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id  where asst.status = 'Active'   and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0'and prd.name = 'Sign Rider'group by prd.name  except select 'Sign Rider', sum(acnt.[OWN_OSR__C])from  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt inner join (select acnt.id acntid from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id  where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0')ast  on acnt.id = ast.acntid
Standard_Listing_Enhancements,select  prd.name, count(*) from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0'and prd.name = 'Standard Listing Enhancements'group by prd.name except select 'Standard Listing Enhancements', sum(acnt.[OWN_OSL__C]) from  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt inner join (select acnt.id acntid from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id  where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0')ast  on acnt.id = ast.acntid
Top_Producer_Website,select  prd.name, count(*) from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id  where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0'and prd.name = 'Top Producer Website'group by prd.name except select 'Top Producer Website', sum(acnt.[OWN_TP_WEBSITE__C]) from  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt inner join (select acnt.id acntid from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id  where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0')ast  on acnt.id = ast.acntid
Website,select  prd.name, count(*)  from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id  where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0'and prd.name = 'Website'group by prd.name  except select 'Website', sum(acnt.[OWN_FEATURED_WEBSITE__C]) from  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt inner join (select acnt.id acntid from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id  where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0')ast  on acnt.id = ast.acntid
Hand_Raiser,select  prd.name, count(*)  from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id  where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0'and prd.name = 'HandRaiser License'group by prd.name  except select 'HandRaiser License', sum(acnt.[HANDRAISER__c]) from  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt inner join (select acnt.id acntid from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id  where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0')ast  on acnt.id = ast.acntid
Home_Search_License,select  prd.name, count(*)  from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id  where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0'and prd.name = 'Home Search License'group by prd.name except select 'Home Search License', sum(acnt.[HOMESRCH__C])from  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt inner join (select acnt.id acntid from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id  where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0')ast  on acnt.id = ast.acntid
Search_and_Paws,select  prd.name, count(*) from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0'and prd.name = 'Search and Paws'group by prd.name except select 'Search and Paws', sum(acnt.[SRCHNPWS__C])from  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt inner join (select acnt.id acntid from REPO_ODS_SRV.[REPO_ODS].[SFDC].[ASSET] asst inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[ACCOUNT] acnt on asst.[ACCOUNTID] = acnt.id  inner join  REPO_ODS_SRV.[REPO_ODS].[SFDC].[PRODUCT2] prd on asst.[PRODUCT2ID] = prd.id  where asst.status = 'Active' and acnt.status__c = 'Active' and acnt.isdeleted = '0'and asst.asset_type__C in ('Parent','Fulfill To') and asst.isdeleted = '0')ast  on acnt.id = ast.acntid
